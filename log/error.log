[2025-08-12 14:11:17 +0800] [30598] [INFO] Starting gunicorn 23.0.0
[2025-08-12 14:11:17 +0800] [30598] [INFO] Listening at: http://10.10.120.225:8787 (30598)
[2025-08-12 14:11:17 +0800] [30598] [INFO] Using worker: sync
[2025-08-12 14:11:17 +0800] [30615] [INFO] Booting worker with pid: 30615
[2025-08-12 14:11:17 +0800] [30620] [INFO] Booting worker with pid: 30620
[2025-08-12 14:11:17 +0800] [30621] [INFO] Booting worker with pid: 30621
[2025-08-12 14:11:17 +0800] [30622] [INFO] Booting worker with pid: 30622
[2025-08-12 14:11:17 +0800] [30623] [INFO] Booting worker with pid: 30623
Loaded your LOCAL configuration at [/data/app/superset/conf/superset_config.py]
Loaded your LOCAL configuration at [/data/app/superset/conf/superset_config.py]
2025-08-12 14:11:18,851:INFO:superset.initialization:Setting database isolation level to READ COMMITTED
2025-08-12 14:11:18,851:INFO:superset.initialization:Setting database isolation level to READ COMMITTED
Loaded your LOCAL configuration at [/data/app/superset/conf/superset_config.py]
2025-08-12 14:11:18,889:INFO:superset.initialization:Setting database isolation level to READ COMMITTED
Loaded your LOCAL configuration at [/data/app/superset/conf/superset_config.py]
2025-08-12 14:11:19,025:INFO:superset.initialization:Setting database isolation level to READ COMMITTED
Loaded your LOCAL configuration at [/data/app/superset/conf/superset_config.py]
2025-08-12 14:11:19,052:INFO:superset.initialization:Setting database isolation level to READ COMMITTED
2025-08-12 14:12:10,069:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 14:12:10,070:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 14:13:58,636:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 14:13:58,636:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 14:57:20,200:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 14:57:20,201:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 15:06:35,550:INFO:superset.commands.sql_lab.execute:Triggering query_id: 10
2025-08-12 15:06:35,571:INFO:superset.sql_lab:Query 10: Executing 1 statement(s)
2025-08-12 15:06:35,571:INFO:superset.sql_lab:Query 10: Set query to 'running'
2025-08-12 15:06:35,607:INFO:superset.sql_lab:Query 10: Running statement 1 out of 1
2025-08-12 15:06:36,250:INFO:superset.sql_lab:Query 10: Storing results in results backend, key: 96b2705c-61da-41fe-9c4c-7d1cf46750d6
2025-08-12 15:07:54,407:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 15:07:54,407:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 15:08:08,945:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 15:08:08,945:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 15:08:16,585:INFO:superset.commands.sql_lab.execute:Triggering query_id: 11
2025-08-12 15:08:16,597:INFO:superset.sqllab.sql_json_executer:Query 11: Running query on a Celery worker
2025-08-12 15:08:24,824:INFO:superset.commands.sql_lab.export:Fetching CSV from results backend [911df4a2-c0c6-4bda-900c-739eddc4d3e6]
2025-08-12 15:08:24,829:INFO:superset.commands.sql_lab.export:Decompressing
2025-08-12 15:08:24,991:INFO:superset.commands.sql_lab.export:Using pandas to convert to CSV
2025-08-12 15:25:54,567:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 15:25:54,568:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 15:26:12,307:ERROR:superset.views.error_handling:list index out of range
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1661, in _parse
    expressions.append(parse_method(self))
                       ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1902, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
                                                                           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 3189, in _parse_select
    query = self._parse_select_query(
            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 3291, in _parse_select_query
    this = self._parse_query_modifiers(this)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 3492, in _parse_query_modifiers
    key, expression = parser(self)
                      ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1254, in <lambda>
    TokenType.WHERE: lambda self: ("where", self._parse_where()),
                                            ^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4464, in _parse_where
    exp.Where, comments=self._prev_comments, this=self._parse_assignment()
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4845, in _parse_assignment
    this = self._parse_disjunction()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4866, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7221, in _parse_tokens
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4869, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7221, in _parse_tokens
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4872, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7228, in _parse_tokens
    expression=parse_method(),
               ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4875, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7221, in _parse_tokens
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4878, in _parse_range
    this = this or self._parse_bitwise()
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5034, in _parse_bitwise
    this = self._parse_term()
           ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5068, in _parse_term
    this = self._parse_factor()
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5091, in _parse_factor
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5116, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
                                    ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/mysql.py", line 674, in _parse_type
    return super()._parse_type(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5178, in _parse_type
    this = self._parse_column()
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5476, in _parse_column
    this = self._parse_column_reference()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5485, in _parse_column_reference
    this = self._parse_field()
           ^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5677, in _parse_field
    field = self._parse_primary() or self._parse_function(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5700, in _parse_function
    func = self._parse_function_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5789, in _parse_function_call
    func = func_builder(args)
           ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1294, in _builder
    raise ParseError(f"INTERVAL expression expected but got '{interval}'")
sqlglot.errors.ParseError: INTERVAL expression expected but got '1'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 487, in get_list_headless
    duration, response = time_function(super().get_list_headless, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/api/__init__.py", line 1642, in get_list_headless
    response[API_RESULT_RES_KEY] = list_model_schema.dump(lst, many=True)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/schema.py", line 557, in dump
    result = self._serialize(processed_obj, many=many)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/schema.py", line 520, in _serialize
    self._serialize(d, many=False)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/schema.py", line 525, in _serialize
    value = field_obj.serialize(attr_name, obj, accessor=self.get_attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/fields.py", line 344, in serialize
    return self._serialize(value, attr, obj, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/fields.py", line 1991, in _serialize
    return self._serialize_method(obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/queries/schemas.py", line 76, in get_sql_tables
    return obj.sql_tables
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/sql_lab.py", line 83, in sql_tables
    extract_tables_from_jinja_sql(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 982, in extract_tables_from_jinja_sql
    ).tables
      ^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 228, in tables
    self._tables = self._extract_tables_from_sql()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 240, in _extract_tables_from_sql
    for statement in SQLScript(self.stripped(), self._engine).statements
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 269, in _parse
    error = ex.errors[0]
            ~~~~~~~~~^^^
IndexError: list index out of range
2025-08-12 15:26:36,903:INFO:superset.commands.sql_lab.execute:Triggering query_id: 12
2025-08-12 15:26:36,913:INFO:superset.sqllab.sql_json_executer:Query 12: Running query on a Celery worker
2025-08-12 15:26:54,301:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 629, in match
    raise NotFound() from None
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-12 15:27:01,312:INFO:superset.commands.sql_lab.execute:Triggering query_id: 13
2025-08-12 15:27:01,321:INFO:superset.sqllab.sql_json_executer:Query 13: Running query on a Celery worker
2025-08-12 15:27:07,317:INFO:superset.commands.sql_lab.execute:Triggering query_id: 14
2025-08-12 15:27:07,325:INFO:superset.sqllab.sql_json_executer:Query 14: Running query on a Celery worker
2025-08-12 15:36:35,734:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 15:36:35,751:INFO:superset.viz:Cache key: 5dbe480fec388d907b9eb7a1502dadd6
2025-08-12 15:36:55,469:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 15:36:55,483:INFO:superset.viz:Cache key: 5dbe480fec388d907b9eb7a1502dadd6
2025-08-12 15:36:55,486:INFO:superset.viz:Serving from cache
2025-08-12 15:40:37,423:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 15:40:37,423:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 15:41:00,473:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
2025-08-12 15:41:07,026:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
2025-08-12 15:41:09,430:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
2025-08-12 15:41:10,669:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
2025-08-12 15:41:14,521:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
2025-08-12 15:41:35,754:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-12 15:49:31,277:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 99.
  SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) as d4_GMV [4mAS[0m `d4_GMV` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER B

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:99
2025-08-12 15:52:05,528:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 99.
  SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) as d4_GMV [4mAS[0m `d4_GMV` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER B

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:99
2025-08-12 15:53:06,234:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(user_num) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'user_num' in 'table list' in AGGREGATE clause")
2025-08-12 15:54:50,620:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(user_num) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'user_num' in 'table list' in AGGREGATE clause")
2025-08-12 15:56:49,773:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(user_num) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'user_num' in 'table list' in AGGREGATE clause")
2025-08-12 15:57:34,621:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(`是否有效例子`) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '是否有效例子' in 'table list' in AGGREGATE clause")
2025-08-12 15:58:49,950:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(user_num) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'user_num' in 'table list' in AGGREGATE clause")
2025-08-12 16:14:51,075:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(user_num) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'user_num' in 'table list' in AGGREGATE clause")
2025-08-12 16:28:52,465:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_user_num_d8)/sum(user_num) AS `d8_转化率` 
FROM dws.dws_sale_camping_user_day GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_转化率` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'user_num' in 'table list' in AGGREGATE clause")
2025-08-12 16:35:11,687:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1941, in get_sqla_query
    where = self._process_sql_expression(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 840, in _process_sql_expression
    expression = validate_adhoc_subquery(
                 ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 137, in validate_adhoc_subquery
    raise SupersetSecurityException(
superset.exceptions.SupersetSecurityException: Custom SQL fields cannot contain sub-queries.
2025-08-12 16:35:43,590:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((substr(期次,1,4) >=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((substr(期次,1,4) >=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 16:35:43,643:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d8) AS `d8_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d8) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((substr(期次,1,4) >=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((substr(期次,1,4) >=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_GMV` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 16:37:28,538:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d8) AS `d8_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d8) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((substr(期次,1,4) >=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((substr(期次,1,4) >=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d8_GMV` DESC 
 LIMIT 10000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 16:38:07,115:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 4541.
  ip_province AS ip_province, ip_city AS ip_city, ip_os AS ip_os, dt AS dt, sum(pay_sum_d8) as d8_GMV [4mAS[0m `d8_GMV`, sum(pay_sum_d4)/sum(user_num) as d4_Rvalue AS `d4_Rvalue`, sum(pay_sum_d4) as d4_GMV AS `

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:4541
2025-08-12 16:38:42,491:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 4541.
  ip_province AS ip_province, ip_city AS ip_city, ip_os AS ip_os, dt AS dt, sum(pay_sum_d8) as d8_GMV [4mAS[0m `d8_GMV`, sum(pay_sum_d4)/sum(user_num) as d4_Rvalue AS `d4_Rvalue`, sum(pay_sum_d4) as d4_GMV AS `

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:4541
2025-08-12 16:39:19,826:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 4541.
  ip_province AS ip_province, ip_city AS ip_city, ip_os AS ip_os, dt AS dt, sum(pay_sum_d8) as d8_GMV [4mAS[0m `d8_GMV`, sum(pay_sum_d4)/sum(user_num) as d4_Rvalue AS `d4_Rvalue`, sum(pay_sum_d4) as d4_GMV AS `

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:4541
2025-08-12 16:41:58,651:WARNING:superset.sql_parse:Unable to parse SQL (Dialects.DORIS): SELECT ...
2025-08-12 16:41:58,654:WARNING:superset.sql_parse:Unable to parse SQL (Dialects.DORIS): SELECT ...
2025-08-12 16:41:58,665:ERROR:superset.views.error_handling:list index out of range
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1661, in _parse
    expressions.append(parse_method(self))
                       ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1902, in _parse_statement
    expression = self._parse_set_operations(expression) if expression else self._parse_select()
                                                                           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 3189, in _parse_select
    query = self._parse_select_query(
            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 3291, in _parse_select_query
    this = self._parse_query_modifiers(this)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 3492, in _parse_query_modifiers
    key, expression = parser(self)
                      ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1254, in <lambda>
    TokenType.WHERE: lambda self: ("where", self._parse_where()),
                                            ^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4464, in _parse_where
    exp.Where, comments=self._prev_comments, this=self._parse_assignment()
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4845, in _parse_assignment
    this = self._parse_disjunction()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4866, in _parse_disjunction
    return self._parse_tokens(self._parse_conjunction, self.DISJUNCTION)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7221, in _parse_tokens
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4869, in _parse_conjunction
    return self._parse_tokens(self._parse_equality, self.CONJUNCTION)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7221, in _parse_tokens
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4872, in _parse_equality
    return self._parse_tokens(self._parse_comparison, self.EQUALITY)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7228, in _parse_tokens
    expression=parse_method(),
               ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4875, in _parse_comparison
    return self._parse_tokens(self._parse_range, self.COMPARISON)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 7221, in _parse_tokens
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 4878, in _parse_range
    this = this or self._parse_bitwise()
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5034, in _parse_bitwise
    this = self._parse_term()
           ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5068, in _parse_term
    this = self._parse_factor()
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5091, in _parse_factor
    this = parse_method()
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5116, in _parse_unary
    return self._parse_at_time_zone(self._parse_type())
                                    ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/mysql.py", line 674, in _parse_type
    return super()._parse_type(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5178, in _parse_type
    this = self._parse_column()
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5476, in _parse_column
    this = self._parse_column_reference()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5485, in _parse_column_reference
    this = self._parse_field()
           ^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5677, in _parse_field
    field = self._parse_primary() or self._parse_function(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5700, in _parse_function
    func = self._parse_function_call(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 5789, in _parse_function_call
    func = func_builder(args)
           ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1294, in _builder
    raise ParseError(f"INTERVAL expression expected but got '{interval}'")
sqlglot.errors.ParseError: INTERVAL expression expected but got '1'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 487, in get_list_headless
    duration, response = time_function(super().get_list_headless, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/api/__init__.py", line 1642, in get_list_headless
    response[API_RESULT_RES_KEY] = list_model_schema.dump(lst, many=True)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/schema.py", line 557, in dump
    result = self._serialize(processed_obj, many=many)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/schema.py", line 520, in _serialize
    self._serialize(d, many=False)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/schema.py", line 525, in _serialize
    value = field_obj.serialize(attr_name, obj, accessor=self.get_attribute)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/fields.py", line 344, in serialize
    return self._serialize(value, attr, obj, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/marshmallow/fields.py", line 1991, in _serialize
    return self._serialize_method(obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/queries/schemas.py", line 76, in get_sql_tables
    return obj.sql_tables
           ^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/sql_lab.py", line 83, in sql_tables
    extract_tables_from_jinja_sql(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 982, in extract_tables_from_jinja_sql
    ).tables
      ^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 228, in tables
    self._tables = self._extract_tables_from_sql()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 240, in _extract_tables_from_sql
    for statement in SQLScript(self.stripped(), self._engine).statements
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 269, in _parse
    error = ex.errors[0]
            ~~~~~~~~~^^^
IndexError: list index out of range
2025-08-12 17:05:51,935:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%y%m%d'')')) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%y%m%d'')')) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 17:05:51,953:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%y%m%d'')')) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%y%m%d'')')) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 17:07:46,275:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((期次 ='250812')) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((期次 ='250812')) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 17:07:46,298:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((期次 ='250812')) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((期次 ='250812')) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-12 17:08:33,283:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((substr(goods_name,2,4)>=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((substr(goods_name,2,4)>=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = (10.42.134.130)[INTERNAL_ERROR]failed to init reader, err: [INTERNAL_ERROR]Init OrcReader failed. reason = Failed to parse the postscript from hdfs://Ucluster/wuhan_hive/warhouse/dws.db/dws_sale_camping_user_day/dt=2025-08-11/000019_0\n\n\t0#  doris::vectorized::OrcReader::_create_file_reader() at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:0\n\t1#  doris::vectorized::OrcReader::init_reader(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const*, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::variant<doris::ColumnValueRange<(doris::PrimitiveType)3>, doris::ColumnValueRange<(doris::PrimitiveType)4>, doris::ColumnValueRange<(doris::PrimitiveType)5>, doris::ColumnValueRange<(doris::PrimitiveType)6>, doris::ColumnValueRange<(doris::PrimitiveType)7>, doris::ColumnValueRange<(doris::PrimitiveType)36>, doris::ColumnValueRange<(doris::PrimitiveType)37>, doris::ColumnValueRange<(doris::PrimitiveType)15>, doris::ColumnValueRange<(doris::PrimitiveType)10>, doris::ColumnValueRange<(doris::PrimitiveType)23>, doris::ColumnValueRange<(doris::PrimitiveType)11>, doris::ColumnValueRange<(doris::PrimitiveType)25>, doris::ColumnValueRange<(doris::PrimitiveType)12>, doris::ColumnValueRange<(doris::PrimitiveType)26>, doris::ColumnValueRange<(doris::PrimitiveType)20>, doris::ColumnValueRange<(doris::PrimitiveType)2>, doris::ColumnValueRange<(doris::PrimitiveType)19>, doris::ColumnValueRange<(doris::PrimitiveType)28>, doris::ColumnValueRange<(doris::PrimitiveType)29>, doris::ColumnValueRange<(doris::PrimitiveType)30>, doris::ColumnValueRange<(doris::PrimitiveType)35> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::variant<doris::ColumnValueRange<(doris::PrimitiveType)3>, doris::ColumnValueRange<(doris::PrimitiveType)4>, doris::ColumnValueRange<(doris::PrimitiveType)5>, doris::ColumnValueRange<(doris::PrimitiveType)6>, doris::ColumnValueRange<(doris::PrimitiveType)7>, doris::ColumnValueRange<(doris::PrimitiveType)36>, doris::ColumnValueRange<(doris::PrimitiveType)37>, doris::ColumnValueRange<(doris::PrimitiveType)15>, doris::ColumnValueRange<(doris::PrimitiveType)10>, doris::ColumnValueRange<(doris::PrimitiveType)23>, doris::ColumnValueRange<(doris::PrimitiveType)11>, doris::ColumnValueRange<(doris::PrimitiveType)25>, doris::ColumnValueRange<(doris::PrimitiveType)12>, doris::ColumnValueRange<(doris::PrimitiveType)26>, doris::ColumnValueRange<(doris::PrimitiveType)20>, doris::ColumnValueRange<(doris::PrimitiveType)2>, doris::ColumnValueRange<(doris::PrimitiveType)19>, doris::ColumnValueRange<(doris::PrimitiveType)28>, doris::ColumnValueRange<(doris::PrimitiveType)29>, doris::ColumnValueRange<(doris::PrimitiveType)30>, doris::ColumnValueRange<(doris::PrimitiveType)35> > > > > const*, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > > const&, bool, doris::TupleDescriptor const*, doris::RowDescriptor const*, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > > const*, std::unordered_map<int, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > >, std::hash<int>, std::equal_to<int>, std::allocator<std::pair<int const, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > > > > > const*, bool) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:505\n\t2#  doris::vectorized::VFileScanner::_get_next_reader() at /home/zcp/repo_center/doris_release/doris/be/src/vec/exec/scan/vfile_scanner.cpp:899\n\t3#  doris::vectorized::VFileScanner::_get_block_wrapped(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:500\n\t4#  doris::vectorized::VFileScanner::_get_block_impl(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:505\n\t5#  doris::vectorized::VScanner::get_block(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/vec/exec/scan/vscanner.cpp:0\n\t6#  doris::vectorized::VScanner::get_block_after_projects(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:505\n\t7#  doris::vectorized::ScannerScheduler::_scanner_scan(std::shared_ptr<doris::vectorized::ScannerContext>, std::shared_ptr<doris::vectorized::ScanTask>) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:391\n\t8#  std::_Function_handler<void (), doris::vectorized::ScannerScheduler::submit(std::shared_ptr<doris::vectorized::ScannerContext>, std::shared_ptr<doris::vectorized::ScanTask>)::$_1::operator()() const::{lambda()#1}>::_M_invoke(std::_Any_data const&) at /var/local/ldb-toolchain/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/shared_ptr_base.h:701\n\t9#  doris::ThreadPool::dispatch_thread() at /home/zcp/repo_center/doris_release/doris/be/src/util/threadpool.cpp:0\n\t10# doris::Thread::supervise_thread(void*) at /var/local/ldb-toolchain/bin/../usr/include/pthread.h:562\n\t11# start_thread\n\t12# __clone\n. cur path: hdfs://Ucluster/wuhan_hive/warhouse/dws.db/dws_sale_camping_user_day/dt=2025-08-11/000019_0')
2025-08-12 17:08:34,013:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((substr(goods_name,2,4)>=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((substr(goods_name,2,4)>=date_format(date_sub(current_date,interval 1 month),'%y%m'))) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = (10.42.72.152)[INTERNAL_ERROR]failed to init reader, err: [INTERNAL_ERROR]Init OrcReader failed. reason = Failed to parse the postscript from hdfs://Ucluster/wuhan_hive/warhouse/dws.db/dws_sale_camping_user_day/dt=2025-08-11/000001_0\n\n\t0#  doris::vectorized::OrcReader::_create_file_reader() at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:0\n\t1#  doris::vectorized::OrcReader::init_reader(std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > const*, std::unordered_map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::variant<doris::ColumnValueRange<(doris::PrimitiveType)3>, doris::ColumnValueRange<(doris::PrimitiveType)4>, doris::ColumnValueRange<(doris::PrimitiveType)5>, doris::ColumnValueRange<(doris::PrimitiveType)6>, doris::ColumnValueRange<(doris::PrimitiveType)7>, doris::ColumnValueRange<(doris::PrimitiveType)36>, doris::ColumnValueRange<(doris::PrimitiveType)37>, doris::ColumnValueRange<(doris::PrimitiveType)15>, doris::ColumnValueRange<(doris::PrimitiveType)10>, doris::ColumnValueRange<(doris::PrimitiveType)23>, doris::ColumnValueRange<(doris::PrimitiveType)11>, doris::ColumnValueRange<(doris::PrimitiveType)25>, doris::ColumnValueRange<(doris::PrimitiveType)12>, doris::ColumnValueRange<(doris::PrimitiveType)26>, doris::ColumnValueRange<(doris::PrimitiveType)20>, doris::ColumnValueRange<(doris::PrimitiveType)2>, doris::ColumnValueRange<(doris::PrimitiveType)19>, doris::ColumnValueRange<(doris::PrimitiveType)28>, doris::ColumnValueRange<(doris::PrimitiveType)29>, doris::ColumnValueRange<(doris::PrimitiveType)30>, doris::ColumnValueRange<(doris::PrimitiveType)35> >, std::hash<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::equal_to<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, std::variant<doris::ColumnValueRange<(doris::PrimitiveType)3>, doris::ColumnValueRange<(doris::PrimitiveType)4>, doris::ColumnValueRange<(doris::PrimitiveType)5>, doris::ColumnValueRange<(doris::PrimitiveType)6>, doris::ColumnValueRange<(doris::PrimitiveType)7>, doris::ColumnValueRange<(doris::PrimitiveType)36>, doris::ColumnValueRange<(doris::PrimitiveType)37>, doris::ColumnValueRange<(doris::PrimitiveType)15>, doris::ColumnValueRange<(doris::PrimitiveType)10>, doris::ColumnValueRange<(doris::PrimitiveType)23>, doris::ColumnValueRange<(doris::PrimitiveType)11>, doris::ColumnValueRange<(doris::PrimitiveType)25>, doris::ColumnValueRange<(doris::PrimitiveType)12>, doris::ColumnValueRange<(doris::PrimitiveType)26>, doris::ColumnValueRange<(doris::PrimitiveType)20>, doris::ColumnValueRange<(doris::PrimitiveType)2>, doris::ColumnValueRange<(doris::PrimitiveType)19>, doris::ColumnValueRange<(doris::PrimitiveType)28>, doris::ColumnValueRange<(doris::PrimitiveType)29>, doris::ColumnValueRange<(doris::PrimitiveType)30>, doris::ColumnValueRange<(doris::PrimitiveType)35> > > > > const*, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > > const&, bool, doris::TupleDescriptor const*, doris::RowDescriptor const*, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > > const*, std::unordered_map<int, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > >, std::hash<int>, std::equal_to<int>, std::allocator<std::pair<int const, std::vector<std::shared_ptr<doris::vectorized::VExprContext>, std::allocator<std::shared_ptr<doris::vectorized::VExprContext> > > > > > const*, bool) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:505\n\t2#  doris::vectorized::VFileScanner::_get_next_reader() at /home/zcp/repo_center/doris_release/doris/be/src/vec/exec/scan/vfile_scanner.cpp:899\n\t3#  doris::vectorized::VFileScanner::_get_block_wrapped(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:500\n\t4#  doris::vectorized::VFileScanner::_get_block_impl(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:505\n\t5#  doris::vectorized::VScanner::get_block(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/vec/exec/scan/vscanner.cpp:0\n\t6#  doris::vectorized::VScanner::get_block_after_projects(doris::RuntimeState*, doris::vectorized::Block*, bool*) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:505\n\t7#  doris::vectorized::ScannerScheduler::_scanner_scan(std::shared_ptr<doris::vectorized::ScannerContext>, std::shared_ptr<doris::vectorized::ScanTask>) at /home/zcp/repo_center/doris_release/doris/be/src/common/status.h:391\n\t8#  std::_Function_handler<void (), doris::vectorized::ScannerScheduler::submit(std::shared_ptr<doris::vectorized::ScannerContext>, std::shared_ptr<doris::vectorized::ScanTask>)::$_1::operator()() const::{lambda()#1}>::_M_invoke(std::_Any_data const&) at /var/local/ldb-toolchain/bin/../lib/gcc/x86_64-linux-gnu/11/../../../../include/c++/11/bits/shared_ptr_base.h:701\n\t9#  doris::ThreadPool::dispatch_thread() at /home/zcp/repo_center/doris_release/doris/be/src/util/threadpool.cpp:0\n\t10# doris::Thread::supervise_thread(void*) at /var/local/ldb-toolchain/bin/../usr/include/pthread.h:562\n\t11# start_thread\n\t12# __clone\n. cur path: hdfs://Ucluster/wuhan_hive/warhouse/dws.db/dws_sale_camping_user_day/dt=2025-08-11/000001_0')
2025-08-12 17:10:20,043:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 4541.
  ip_province AS ip_province, ip_city AS ip_city, ip_os AS ip_os, dt AS dt, sum(pay_sum_d8) as d8_GMV [4mAS[0m `d8_GMV`, sum(pay_sum_d4)/sum(user_num) as d4_Rvalue AS `d4_Rvalue`, sum(pay_sum_d4) as d4_GMV AS `

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:4541
2025-08-12 17:10:24,346:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 267, in _parse
    return sqlglot.parse(script, dialect=dialect)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/__init__.py", line 102, in parse
    return Dialect.get_or_raise(read or dialect).parse(sql, **opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/dialects/dialect.py", line 1022, in parse
    return self.parser(**opts).parse(self.tokenize(sql), sql)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1592, in parse
    return self._parse(
           ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1664, in _parse
    self.raise_error("Invalid expression / Unexpected token")
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/sqlglot/parser.py", line 1705, in raise_error
    raise error
sqlglot.errors.ParseError: Invalid expression / Unexpected token. Line 1, Col: 4541.
  ip_province AS ip_province, ip_city AS ip_city, ip_os AS ip_os, dt AS dt, sum(pay_sum_d8) as d8_GMV [4mAS[0m `d8_GMV`, sum(pay_sum_d4)/sum(user_num) as d4_Rvalue AS `d4_Rvalue`, sum(pay_sum_d4) as d4_GMV AS `

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1858, in execute
    if sql_parse.check_sql_functions_exist(query, disallowed_functions, cls.engine):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql_parse.py", line 183, in check_sql_functions_exist
    return SQLScript(sql, engine=engine).check_functions_present(function_list)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 670, in __init__
    self.statements = statement_class.split_script(script, engine)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 294, in split_script
    for ast in cls._parse(script, engine)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sql/parse.py", line 270, in _parse
    raise SupersetParseError(
superset.exceptions.SupersetParseError: Error parsing near 'AS' at line 1:4541
2025-08-12 17:39:54,973:WARNING:superset.views.error_handling:SupersetSecurityException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1664, in get_sqla_query
    selected = validate_adhoc_subquery(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 137, in validate_adhoc_subquery
    raise SupersetSecurityException(
superset.exceptions.SupersetSecurityException: Custom SQL fields cannot contain sub-queries.
2025-08-12 17:42:38,146:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/utils.py", line 148, in get_columns_description
    cursor.execute(mutated_query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = \nextraneous input ',' expecting {'(', '[', '{', '}', 'ACTIONS', 'ADD', 'ADDDATE', 'AFTER', 'AGG_STATE', 'AGGREGATE', 'ALIAS', 'ANALYZED', 'ARRAY', 'ARRAY_RANGE', 'AT', 'AUTHORS', 'AUTO_INCREMENT', 'ALWAYS', 'BACKENDS', 'BACKUP', 'BEGIN', 'BELONG', 'BIN', 'BINARY', 'BITAND', 'BITMAP', 'BITMAP_EMPTY', 'BITMAP_UNION', 'BITOR', 'BITXOR', 'BLOB', 'BOOLEAN', 'BRIEF', 'BROKER', 'BUCKETS', 'BUILD', 'BUILTIN', 'BULK', 'CACHE', 'CACHED', 'CALL', 'CASE', 'CAST', 'CATALOG', 'CATALOGS', 'CHAIN', CHAR, 'CHARSET', 'CHECK', 'CLUSTER', 'CLUSTERS', 'COLLATION', 'COLLECT', 'COLOCATE', 'COLUMNS', 'COMMENT', 'COMMIT', 'COMMITTED', 'COMPACT', 'COMPLETE', 'COMPRESS_TYPE', 'COMPUTE', 'CONDITIONS', 'CONFIG', 'CONNECTION', 'CONNECTION_ID', 'CONSISTENT', 'CONSTRAINTS', 'CONVERT', 'CONVERT_LIGHT_SCHEMA_CHANGE_PROCESS', 'COPY', 'COUNT', 'CREATION', 'CRON', 'CURRENT_CATALOG', 'CURRENT_DATE', 'CURRENT_TIME', 'CURRENT_TIMESTAMP', 'CURRENT_USER', 'DATA', 'DATABASE', 'DATE', 'DATE_ADD', 'DATE_CEIL', 'DATE_DIFF', 'DATE_FLOOR', 'DATE_SUB', 'DATEADD', 'DATEDIFF', 'DATETIME', 'DATETIMEV2', 'DATEV2', 'DATETIMEV1', 'DATEV1', 'DAY', 'DAYS_ADD', 'DAYS_SUB', 'DECIMAL', 'DECIMALV2', 'DECIMALV3', 'DEFERRED', 'DEMAND', 'DIAGNOSE', 'DIAGNOSIS', 'DISTINCTPC', 'DISTINCTPCSA', 'DO', 'DORIS_INTERNAL_TABLE_ID', 'DUAL', 'DYNAMIC', 'E', 'ENABLE', 'ENCRYPTKEY', 'ENCRYPTKEYS', 'END', 'ENDS', 'ENGINE', 'ENGINES', 'ERRORS', 'EVENTS', 'EVERY', 'EXCLUDE', 'EXISTS', 'EXPIRED', 'EXTERNAL', 'EXTRACT', 'FAILED_LOGIN_ATTEMPTS', 'FALSE', 'FAST', 'FEATURE', 'FIELDS', 'FILE', 'FILTER', 'FIRST', 'FORMAT', 'FREE', 'FRONTENDS', 'FUNCTION', 'GENERATED', 'GENERIC', 'GLOBAL', 'GRAPH', 'GROUPING', 'GROUPS', 'HASH', 'HDFS', 'HELP', 'HISTOGRAM', 'HLL_UNION', 'HOSTNAME', 'HOTSPOT', 'HOUR', 'HUB', 'IDENTIFIED', 'IF', 'IGNORE', 'IMMEDIATE', 'INCREMENTAL', 'INDEXES', 'INTERVAL', 'INVERTED', 'IPV4', 'IPV6', 'IS_NOT_NULL_PRED', 'IS_NULL_PRED', 'ISNULL', 'ISOLATION', 'JOB', 'JOBS', 'JSON', 'JSONB', 'KEY', 'LABEL', 'LAST', 'LDAP', 'LDAP_ADMIN_PASSWORD', 'LEFT', 'LESS', 'LEVEL', 'LIKE', 'LINES', 'LINK', 'LOCAL', 'LOCALTIME', 'LOCALTIMESTAMP', 'LOCATION', 'LOCK', 'LOGICAL', 'MANUAL', 'MAP', 'MATCH_ALL', 'MATCH_ANY', 'MATCH_PHRASE', 'MATCH_PHRASE_EDGE', 'MATCH_PHRASE_PREFIX', 'MATCH_REGEXP', 'MATERIALIZED', 'MAX', 'MEMO', 'MERGE', 'MIGRATE', 'MIGRATIONS', 'MIN', 'MINUTE', 'MODIFY', 'MONTH', 'MTMV', 'NAME', 'NAMES', 'NEGATIVE', 'NEVER', 'NEXT', 'NGRAM_BF', 'NO', 'NON_NULLABLE', 'NOT', 'NULL', 'NULLS', 'OF', 'OFFSET', 'ONLY', 'OPEN', 'OPTIMIZED', 'PARAMETER', 'PARSED', 'PARTITIONS', 'PASSWORD', 'PASSWORD_EXPIRE', 'PASSWORD_HISTORY', 'PASSWORD_LOCK_TIME', 'PASSWORD_REUSE', 'PATH', 'PAUSE', 'PERCENT', 'PERIOD', 'PERMISSIVE', 'PHYSICAL', 'PI', '?', 'PLAN', 'PRIVILEGES', 'PROCESS', 'PLUGIN', 'PLUGINS', 'POLICY', 'PROC', 'PROCESSLIST', 'PROFILE', 'PROPERTIES', 'PROPERTY', 'QUANTILE_STATE', 'QUANTILE_UNION', 'QUERY', 'QUOTA', 'RANDOM', 'RECENT', 'RECOVER', 'RECYCLE', 'REFRESH', 'REGEXP', 'REPEATABLE', 'REPLACE', 'REPLACE_IF_NOT_NULL', 'REPLAYER', 'REPOSITORIES', 'REPOSITORY', 'RESOURCE', 'RESOURCES', 'RESTORE', 'RESTRICTIVE', 'RESUME', 'RETURNS', 'REWRITTEN', 'RIGHT', 'RLIKE', 'ROLLBACK', 'ROLLUP', 'ROUTINE', 'S3', 'SAMPLE', 'SCHEDULE', 'SCHEDULER', 'SCHEMA', 'SECOND', 'SEQUENCE', 'SERIALIZABLE', 'SESSION', 'SESSION_USER', 'SET_SESSION_VARIABLE', 'SHAPE', 'SKEW', 'SNAPSHOT', 'SONAME', 'SPLIT', 'SQL', 'STAGE', 'STAGES', 'START', 'STARTS', 'STATS', 'STATUS', 'STOP', 'STORAGE', 'STREAM', 'STREAMING', 'STRING', 'STRUCT', 'SUBDATE', 'SUM', 'TABLES', 'TASK', 'TASKS', 'TEMPORARY', 'TEXT', 'THAN', 'TIME', 'TIMESTAMP', 'TIMESTAMPADD', 'TIMESTAMPDIFF', 'TRANSACTION', 'TREE', 'TRIGGERS', 'TRIM', 'TRUE', 'TRUNCATE', 'TYPE', 'TYPES', 'UNCOMMITTED', 'UNLOCK', 'UNSET', 'UP', 'USER', 'VALUE', 'VARCHAR', 'VARIABLE', 'VARIABLES', 'VARIANT', 'VAULT', 'VAULTS', 'VERBOSE', 'VERSION', 'VIEW', 'VIEWS', 'WARM', 'WARNINGS', 'WEEK', 'WORK', 'YEAR', '+', '-', '*', '~', '!', '/*+', '*/', '/*', '@', '@@', STRING_LITERAL, INTEGER_VALUE, EXPONENT_VALUE, DECIMAL_VALUE, IDENTIFIER, BACKQUOTED_IDENTIFIER}(line 27, pos 5)\n")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/api/__init__.py", line 187, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 175, in external_metadata_by_name
    external_metadata = datasource.external_metadata()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1381, in external_metadata
    return get_virtual_table_metadata(dataset=self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/utils.py", line 126, in get_virtual_table_metadata
    return get_columns_description(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/utils.py", line 154, in get_columns_description
    raise SupersetGenericDBErrorException(message=str(ex)) from ex
superset.exceptions.SupersetGenericDBErrorException: (1105, "errCode = 2, detailMessage = \nextraneous input ',' expecting {'(', '[', '{', '}', 'ACTIONS', 'ADD', 'ADDDATE', 'AFTER', 'AGG_STATE', 'AGGREGATE', 'ALIAS', 'ANALYZED', 'ARRAY', 'ARRAY_RANGE', 'AT', 'AUTHORS', 'AUTO_INCREMENT', 'ALWAYS', 'BACKENDS', 'BACKUP', 'BEGIN', 'BELONG', 'BIN', 'BINARY', 'BITAND', 'BITMAP', 'BITMAP_EMPTY', 'BITMAP_UNION', 'BITOR', 'BITXOR', 'BLOB', 'BOOLEAN', 'BRIEF', 'BROKER', 'BUCKETS', 'BUILD', 'BUILTIN', 'BULK', 'CACHE', 'CACHED', 'CALL', 'CASE', 'CAST', 'CATALOG', 'CATALOGS', 'CHAIN', CHAR, 'CHARSET', 'CHECK', 'CLUSTER', 'CLUSTERS', 'COLLATION', 'COLLECT', 'COLOCATE', 'COLUMNS', 'COMMENT', 'COMMIT', 'COMMITTED', 'COMPACT', 'COMPLETE', 'COMPRESS_TYPE', 'COMPUTE', 'CONDITIONS', 'CONFIG', 'CONNECTION', 'CONNECTION_ID', 'CONSISTENT', 'CONSTRAINTS', 'CONVERT', 'CONVERT_LIGHT_SCHEMA_CHANGE_PROCESS', 'COPY', 'COUNT', 'CREATION', 'CRON', 'CURRENT_CATALOG', 'CURRENT_DATE', 'CURRENT_TIME', 'CURRENT_TIMESTAMP', 'CURRENT_USER', 'DATA', 'DATABASE', 'DATE', 'DATE_ADD', 'DATE_CEIL', 'DATE_DIFF', 'DATE_FLOOR', 'DATE_SUB', 'DATEADD', 'DATEDIFF', 'DATETIME', 'DATETIMEV2', 'DATEV2', 'DATETIMEV1', 'DATEV1', 'DAY', 'DAYS_ADD', 'DAYS_SUB', 'DECIMAL', 'DECIMALV2', 'DECIMALV3', 'DEFERRED', 'DEMAND', 'DIAGNOSE', 'DIAGNOSIS', 'DISTINCTPC', 'DISTINCTPCSA', 'DO', 'DORIS_INTERNAL_TABLE_ID', 'DUAL', 'DYNAMIC', 'E', 'ENABLE', 'ENCRYPTKEY', 'ENCRYPTKEYS', 'END', 'ENDS', 'ENGINE', 'ENGINES', 'ERRORS', 'EVENTS', 'EVERY', 'EXCLUDE', 'EXISTS', 'EXPIRED', 'EXTERNAL', 'EXTRACT', 'FAILED_LOGIN_ATTEMPTS', 'FALSE', 'FAST', 'FEATURE', 'FIELDS', 'FILE', 'FILTER', 'FIRST', 'FORMAT', 'FREE', 'FRONTENDS', 'FUNCTION', 'GENERATED', 'GENERIC', 'GLOBAL', 'GRAPH', 'GROUPING', 'GROUPS', 'HASH', 'HDFS', 'HELP', 'HISTOGRAM', 'HLL_UNION', 'HOSTNAME', 'HOTSPOT', 'HOUR', 'HUB', 'IDENTIFIED', 'IF', 'IGNORE', 'IMMEDIATE', 'INCREMENTAL', 'INDEXES', 'INTERVAL', 'INVERTED', 'IPV4', 'IPV6', 'IS_NOT_NULL_PRED', 'IS_NULL_PRED', 'ISNULL', 'ISOLATION', 'JOB', 'JOBS', 'JSON', 'JSONB', 'KEY', 'LABEL', 'LAST', 'LDAP', 'LDAP_ADMIN_PASSWORD', 'LEFT', 'LESS', 'LEVEL', 'LIKE', 'LINES', 'LINK', 'LOCAL', 'LOCALTIME', 'LOCALTIMESTAMP', 'LOCATION', 'LOCK', 'LOGICAL', 'MANUAL', 'MAP', 'MATCH_ALL', 'MATCH_ANY', 'MATCH_PHRASE', 'MATCH_PHRASE_EDGE', 'MATCH_PHRASE_PREFIX', 'MATCH_REGEXP', 'MATERIALIZED', 'MAX', 'MEMO', 'MERGE', 'MIGRATE', 'MIGRATIONS', 'MIN', 'MINUTE', 'MODIFY', 'MONTH', 'MTMV', 'NAME', 'NAMES', 'NEGATIVE', 'NEVER', 'NEXT', 'NGRAM_BF', 'NO', 'NON_NULLABLE', 'NOT', 'NULL', 'NULLS', 'OF', 'OFFSET', 'ONLY', 'OPEN', 'OPTIMIZED', 'PARAMETER', 'PARSED', 'PARTITIONS', 'PASSWORD', 'PASSWORD_EXPIRE', 'PASSWORD_HISTORY', 'PASSWORD_LOCK_TIME', 'PASSWORD_REUSE', 'PATH', 'PAUSE', 'PERCENT', 'PERIOD', 'PERMISSIVE', 'PHYSICAL', 'PI', '?', 'PLAN', 'PRIVILEGES', 'PROCESS', 'PLUGIN', 'PLUGINS', 'POLICY', 'PROC', 'PROCESSLIST', 'PROFILE', 'PROPERTIES', 'PROPERTY', 'QUANTILE_STATE', 'QUANTILE_UNION', 'QUERY', 'QUOTA', 'RANDOM', 'RECENT', 'RECOVER', 'RECYCLE', 'REFRESH', 'REGEXP', 'REPEATABLE', 'REPLACE', 'REPLACE_IF_NOT_NULL', 'REPLAYER', 'REPOSITORIES', 'REPOSITORY', 'RESOURCE', 'RESOURCES', 'RESTORE', 'RESTRICTIVE', 'RESUME', 'RETURNS', 'REWRITTEN', 'RIGHT', 'RLIKE', 'ROLLBACK', 'ROLLUP', 'ROUTINE', 'S3', 'SAMPLE', 'SCHEDULE', 'SCHEDULER', 'SCHEMA', 'SECOND', 'SEQUENCE', 'SERIALIZABLE', 'SESSION', 'SESSION_USER', 'SET_SESSION_VARIABLE', 'SHAPE', 'SKEW', 'SNAPSHOT', 'SONAME', 'SPLIT', 'SQL', 'STAGE', 'STAGES', 'START', 'STARTS', 'STATS', 'STATUS', 'STOP', 'STORAGE', 'STREAM', 'STREAMING', 'STRING', 'STRUCT', 'SUBDATE', 'SUM', 'TABLES', 'TASK', 'TASKS', 'TEMPORARY', 'TEXT', 'THAN', 'TIME', 'TIMESTAMP', 'TIMESTAMPADD', 'TIMESTAMPDIFF', 'TRANSACTION', 'TREE', 'TRIGGERS', 'TRIM', 'TRUE', 'TRUNCATE', 'TYPE', 'TYPES', 'UNCOMMITTED', 'UNLOCK', 'UNSET', 'UP', 'USER', 'VALUE', 'VARCHAR', 'VARIABLE', 'VARIABLES', 'VARIANT', 'VAULT', 'VAULTS', 'VERBOSE', 'VERSION', 'VIEW', 'VIEWS', 'WARM', 'WARNINGS', 'WEEK', 'WORK', 'YEAR', '+', '-', '*', '~', '!', '/*+', '*/', '/*', '@', '@@', STRING_LITERAL, INTEGER_VALUE, EXPONENT_VALUE, DECIMAL_VALUE, IDENTIFIER, BACKQUOTED_IDENTIFIER}(line 27, pos 5)\n")
2025-08-12 17:45:39,035:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(is_effective_user) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-12 00:00:00.000000' AND `期次对应日期` < '2025-08-12 00:00:00.000000' GROUP BY `期次值`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'is_effective_user' in 'table list' in AGGREGATE clause")
2025-08-12 17:45:39,186:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(pay_sum_d8) AS `D8_GMV` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-12 00:00:00.000000' AND `期次对应日期` < '2025-08-12 00:00:00.000000' GROUP BY `期次值`, `投放部门` ORDER BY `D8_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'pay_sum_d8' in 'table list' in AGGREGATE clause")
2025-08-12 17:57:08,689:WARNING:superset.views.error_handling:SupersetSecurityException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1664, in get_sqla_query
    selected = validate_adhoc_subquery(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 137, in validate_adhoc_subquery
    raise SupersetSecurityException(
superset.exceptions.SupersetSecurityException: Custom SQL fields cannot contain sub-queries.
2025-08-12 18:02:31,673:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:02:31,683:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:02:32,667:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:42:39,347:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:42:39,359:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:42:39,361:INFO:superset.viz:Serving from cache
2025-08-12 18:42:39,371:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:42:39,381:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:42:39,382:INFO:superset.viz:Serving from cache
2025-08-12 18:42:42,101:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:42:42,112:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:42:42,137:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:42:42,147:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:59:39,308:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:59:39,319:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:59:39,321:INFO:superset.viz:Serving from cache
2025-08-12 18:59:39,341:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:59:39,353:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:59:39,354:INFO:superset.viz:Serving from cache
2025-08-12 18:59:41,537:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:59:41,549:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 18:59:41,563:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 18:59:41,573:INFO:superset.viz:Cache key: 0abc9a1925eb4e5e1dcb7647fc14d1fb
2025-08-12 19:00:05,688:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:05,698:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:05,713:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:05,723:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:12,594:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:12,604:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:12,605:INFO:superset.viz:Serving from cache
2025-08-12 19:00:12,622:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:12,632:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:12,633:INFO:superset.viz:Serving from cache
2025-08-12 19:00:17,568:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:17,578:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:17,580:INFO:superset.viz:Serving from cache
2025-08-12 19:00:17,597:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:17,606:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:17,608:INFO:superset.viz:Serving from cache
2025-08-12 19:00:20,790:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:20,799:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:20,800:INFO:superset.viz:Serving from cache
2025-08-12 19:00:20,820:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:20,831:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:20,833:INFO:superset.viz:Serving from cache
2025-08-12 19:00:23,810:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:23,820:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:23,821:INFO:superset.viz:Serving from cache
2025-08-12 19:00:23,839:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:23,847:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:23,849:INFO:superset.viz:Serving from cache
2025-08-12 19:00:31,372:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:31,373:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:31,381:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:31,382:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:31,383:INFO:superset.viz:Serving from cache
2025-08-12 19:00:31,384:INFO:superset.viz:Serving from cache
2025-08-12 19:00:38,272:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:38,282:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:38,283:INFO:superset.viz:Serving from cache
2025-08-12 19:00:38,300:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:38,309:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:38,310:INFO:superset.viz:Serving from cache
2025-08-12 19:00:42,261:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:42,271:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:42,272:INFO:superset.viz:Serving from cache
2025-08-12 19:00:42,290:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:00:42,300:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:00:42,301:INFO:superset.viz:Serving from cache
2025-08-12 19:01:12,502:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:12,512:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:12,513:INFO:superset.viz:Serving from cache
2025-08-12 19:01:12,539:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:12,549:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:12,551:INFO:superset.viz:Serving from cache
2025-08-12 19:01:16,826:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:16,836:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:16,838:INFO:superset.viz:Serving from cache
2025-08-12 19:01:16,857:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:16,866:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:16,868:INFO:superset.viz:Serving from cache
2025-08-12 19:01:23,690:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:23,699:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:23,701:INFO:superset.viz:Serving from cache
2025-08-12 19:01:23,729:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:23,738:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:23,740:INFO:superset.viz:Serving from cache
2025-08-12 19:01:27,861:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:27,872:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:27,873:INFO:superset.viz:Serving from cache
2025-08-12 19:01:27,881:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:27,890:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:27,892:INFO:superset.viz:Serving from cache
2025-08-12 19:01:32,548:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:32,558:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:32,560:INFO:superset.viz:Serving from cache
2025-08-12 19:01:32,579:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:32,588:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:32,589:INFO:superset.viz:Serving from cache
2025-08-12 19:01:37,130:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:37,140:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:37,141:INFO:superset.viz:Serving from cache
2025-08-12 19:01:37,168:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:37,179:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:37,180:INFO:superset.viz:Serving from cache
2025-08-12 19:01:40,763:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:40,773:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:40,774:INFO:superset.viz:Serving from cache
2025-08-12 19:01:40,793:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:40,803:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:40,804:INFO:superset.viz:Serving from cache
2025-08-12 19:01:44,924:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:44,933:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:01:44,952:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:01:44,961:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:02:36,537:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:02:36,547:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:02:36,548:INFO:superset.viz:Serving from cache
2025-08-12 19:02:36,574:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:02:36,584:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:02:36,585:INFO:superset.viz:Serving from cache
2025-08-12 19:02:52,992:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:02:53,001:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:02:53,003:INFO:superset.viz:Serving from cache
2025-08-12 19:02:53,020:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:02:53,029:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:02:53,030:INFO:superset.viz:Serving from cache
2025-08-12 19:03:01,158:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:03:01,161:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:03:01,161:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:03:01,169:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:03:01,170:INFO:superset.viz:Serving from cache
2025-08-12 19:03:01,171:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:03:01,172:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:03:01,173:INFO:superset.viz:Serving from cache
2025-08-12 19:03:01,173:INFO:superset.viz:Serving from cache
2025-08-12 19:03:53,134:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:03:53,143:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:03:53,145:INFO:superset.viz:Serving from cache
2025-08-12 19:04:03,075:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:04:03,087:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:04:03,088:INFO:superset.viz:Serving from cache
2025-08-12 19:06:45,694:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:06:45,705:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:06:45,707:INFO:superset.viz:Serving from cache
2025-08-12 19:07:07,521:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:07:07,532:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:07:07,534:INFO:superset.viz:Serving from cache
2025-08-12 19:07:09,509:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 19:07:09,510:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 19:10:54,293:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:10:54,304:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:10:54,306:INFO:superset.viz:Serving from cache
2025-08-12 19:11:03,090:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:11:03,102:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:11:03,104:INFO:superset.viz:Serving from cache
2025-08-12 19:11:42,057:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:11:42,073:INFO:superset.viz:Cache key: 296b46ec0726c4bcfc0c78688e1169cf
2025-08-12 19:11:42,241:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:11:42,250:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:11:42,252:INFO:superset.viz:Serving from cache
2025-08-12 19:12:12,313:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:12:12,325:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:12:12,327:INFO:superset.viz:Serving from cache
2025-08-12 19:12:28,815:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:12:28,826:INFO:superset.viz:Cache key: 04fa581d24442512e972f06975431dd2
2025-08-12 19:12:34,138:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:12:34,150:INFO:superset.viz:Cache key: 296b46ec0726c4bcfc0c78688e1169cf
2025-08-12 19:12:34,152:INFO:superset.viz:Serving from cache
2025-08-12 19:12:56,867:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:12:56,878:INFO:superset.viz:Cache key: 4b87352186779372d443dec0c7679f6c
2025-08-12 19:13:09,979:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:13:09,995:INFO:superset.viz:Cache key: dc966636ffba2d3eac7446c87234dad3
2025-08-12 19:13:27,268:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 19:13:27,268:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 19:13:51,346:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:13:51,357:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:13:51,359:INFO:superset.viz:Serving from cache
2025-08-12 19:14:18,330:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:14:18,342:INFO:superset.viz:Cache key: 01942c22f089ea888e8a338a30cee475
2025-08-12 19:14:35,408:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 19:14:35,409:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 19:14:44,197:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:14:44,208:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:14:44,210:INFO:superset.viz:Serving from cache
2025-08-12 19:14:55,943:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:14:55,952:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:14:55,954:INFO:superset.viz:Serving from cache
2025-08-12 19:15:02,145:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:15:02,155:INFO:superset.viz:Cache key: 01942c22f089ea888e8a338a30cee475
2025-08-12 19:15:02,157:INFO:superset.viz:Serving from cache
2025-08-12 19:15:11,552:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:15:11,563:INFO:superset.viz:Cache key: db965f216f3500180cea29eafc8d233a
2025-08-12 19:15:23,229:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:15:23,240:INFO:superset.viz:Cache key: 2f23b684dcb3aedc33e83fc62f9cddf6
2025-08-12 19:15:32,435:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:15:32,446:INFO:superset.viz:Cache key: 4b87352186779372d443dec0c7679f6c
2025-08-12 19:15:32,448:INFO:superset.viz:Serving from cache
2025-08-12 19:17:14,376:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 19:17:14,386:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 19:17:14,388:INFO:superset.viz:Serving from cache
2025-08-12 19:18:57,071:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 19:18:57,071:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 23:37:22,649:WARNING:root:Failed to add user to db session: Class 'werkzeug.local.LocalProxy' is not mapped
2025-08-12 23:37:22,764:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 23:37:22,764:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 23:37:48,358:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 23:37:48,359:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 23:37:52,340:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:37:52,352:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 23:38:02,723:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:38:02,735:INFO:superset.viz:Cache key: 4b87352186779372d443dec0c7679f6c
2025-08-12 23:39:28,002:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:39:28,011:INFO:superset.viz:Cache key: 2f23b684dcb3aedc33e83fc62f9cddf6
2025-08-12 23:46:47,027:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:46:47,036:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 23:46:47,038:INFO:superset.viz:Serving from cache
2025-08-12 23:49:05,958:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:49:05,968:INFO:superset.viz:Cache key: baf64a8881bbdf255f308967fa70506c
2025-08-12 23:49:13,756:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:49:13,765:INFO:superset.viz:Cache key: 6870c75d595e2b518438f24b1145c270
2025-08-12 23:50:24,603:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-12 23:50:24,604:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-12 23:50:30,173:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-12 23:50:30,183:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-12 23:50:30,184:INFO:superset.viz:Serving from cache
2025-08-13 00:24:33,240:INFO:superset.commands.sql_lab.execute:Triggering query_id: 15
2025-08-13 00:24:33,247:INFO:superset.sqllab.sql_json_executer:Query 15: Running query on a Celery worker
2025-08-13 00:24:36,369:INFO:superset.commands.sql_lab.execute:Triggering query_id: 16
2025-08-13 00:24:36,377:INFO:superset.sqllab.sql_json_executer:Query 16: Running query on a Celery worker
2025-08-13 00:25:30,310:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 00:25:36,125:INFO:superset.commands.sql_lab.execute:Triggering query_id: 17
2025-08-13 00:25:36,169:INFO:superset.sqllab.sql_json_executer:Query 17: Running query on a Celery worker
2025-08-13 00:25:42,073:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 00:25:42,074:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 00:25:54,393:INFO:superset.commands.sql_lab.execute:Triggering query_id: 18
2025-08-13 00:25:54,453:INFO:superset.sqllab.sql_json_executer:Query 18: Running query on a Celery worker
2025-08-13 00:26:03,240:INFO:superset.commands.sql_lab.execute:Triggering query_id: 19
2025-08-13 00:26:03,281:INFO:superset.sqllab.sql_json_executer:Query 19: Running query on a Celery worker
2025-08-13 00:26:22,853:INFO:superset.commands.sql_lab.execute:Triggering query_id: 20
2025-08-13 00:26:22,895:INFO:superset.sqllab.sql_json_executer:Query 20: Running query on a Celery worker
2025-08-13 00:26:34,956:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 00:27:04,306:WARNING:superset.connectors.sqla.models:Query SELECT * AS `我的列` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = Invalid call to 用户ID, 品类, 投放部门, 渠道, 渠道(中文), 部门, 组, h5id, h5归属人, 版位, 价格, 收集手机号, 链路类型-新, 投放账户id, 修正账号, 投放计划id, 投放素材id, 微信unionid, 手机号, 创建时间, 加微时间, 加微状态, 专栏id, 专栏名称, 期次值, 期次对应日期, 小鹅通ID, 是否填写问卷, 交易状态, 已领券, 用户状态, 销售id, 销售, AI销售SOP类型, 是否购买, 首次购买时间, 正价课订单数, 正价课GMV, 首次购买状态, 是否老用户, 是否老用户(30天内), D4正价课购买人数, D4正价课订单数, D4正价课GMV, D5正价课购买人数, D5正价课订单数, D5正价课GMV, D6正价课购买人数, D6正价课订单数, D6正价课GMV, D7正价课购买人数, D7正价课订单数, D7正价课GMV, D8正价课购买人数, D8正价课订单数, D8正价课GMV, D9正价课购买人数, D9正价课订单数, D9正价课GMV, D10正价课购买人数, D10正价课订单数, D10正价课GMV, D11正价课购买人数, D11正价课订单数, D11正价课GMV, D12正价课购买人数, D12正价课订单数, D12正价课GMV, D13正价课购买人数, D13正价课订单数, D13正价课GMV, D14正价课购买人数, D14正价课订单数, D14正价课GMV, 是否主动加微, 海外/国内, 国家编码, 太极兴趣度, 太极影响, 女性1：男性0, 45岁年龄以上, 手机型号, 地址, 是否来自于大城市（二线及以上）, IP所在省份, IP所在城市, 用户操作系统, 是否有效用户, 省份ISO编码.getDataType() on unbound object')
2025-08-13 00:27:24,751:INFO:superset.commands.sql_lab.execute:Triggering query_id: 21
2025-08-13 00:27:24,759:INFO:superset.sqllab.sql_json_executer:Query 21: Running query on a Celery worker
2025-08-13 00:27:31,539:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 00:27:31,540:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 00:28:02,891:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 00:28:02,905:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 00:28:02,907:INFO:superset.viz:Serving from cache
2025-08-13 00:29:34,475:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 00:29:34,487:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 00:29:34,489:INFO:superset.viz:Serving from cache
2025-08-13 00:30:12,636:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 00:30:12,646:INFO:superset.viz:Cache key: 296b46ec0726c4bcfc0c78688e1169cf
2025-08-13 09:12:54,252:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 09:12:54,253:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 09:13:57,816:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 09:15:26,252:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 09:15:26,263:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 09:15:44,497:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 09:15:44,509:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 09:15:44,510:INFO:superset.viz:Serving from cache
2025-08-13 09:15:57,381:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 09:15:57,391:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 09:15:57,392:INFO:superset.viz:Serving from cache
2025-08-13 09:16:35,223:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 09:16:35,234:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 09:16:35,235:INFO:superset.viz:Serving from cache
2025-08-13 09:27:05,414:WARNING:superset.daos.datasource:Datasource not found datasource_type: table, datasource_id: 0
2025-08-13 09:27:05,527:WARNING:superset.daos.datasource:Datasource not found datasource_type: table, datasource_id: 0
2025-08-13 09:27:26,306:WARNING:superset.connectors.sqla.models:Query SELECT * AS `我的列` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = Invalid call to 用户ID, 品类, 投放部门, 渠道, 渠道(中文), 部门, 组, h5id, h5归属人, 版位, 价格, 收集手机号, 链路类型-新, 投放账户id, 修正账号, 投放计划id, 投放素材id, 微信unionid, 手机号, 创建时间, 加微时间, 加微状态, 专栏id, 专栏名称, 期次值, 期次对应日期, 小鹅通ID, 是否填写问卷, 交易状态, 已领券, 用户状态, 销售id, 销售, AI销售SOP类型, 是否购买, 首次购买时间, 正价课订单数, 正价课GMV, 首次购买状态, 是否老用户, 是否老用户(30天内), D4正价课购买人数, D4正价课订单数, D4正价课GMV, D5正价课购买人数, D5正价课订单数, D5正价课GMV, D6正价课购买人数, D6正价课订单数, D6正价课GMV, D7正价课购买人数, D7正价课订单数, D7正价课GMV, D8正价课购买人数, D8正价课订单数, D8正价课GMV, D9正价课购买人数, D9正价课订单数, D9正价课GMV, D10正价课购买人数, D10正价课订单数, D10正价课GMV, D11正价课购买人数, D11正价课订单数, D11正价课GMV, D12正价课购买人数, D12正价课订单数, D12正价课GMV, D13正价课购买人数, D13正价课订单数, D13正价课GMV, D14正价课购买人数, D14正价课订单数, D14正价课GMV, 是否主动加微, 海外/国内, 国家编码, 太极兴趣度, 太极影响, 女性1：男性0, 45岁年龄以上, 手机型号, 地址, 是否来自于大城市（二线及以上）, IP所在省份, IP所在城市, 用户操作系统, 是否有效用户, 省份ISO编码.getDataType() on unbound object')
2025-08-13 09:27:26,341:WARNING:superset.connectors.sqla.models:Query SELECT * AS `我的列` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = Invalid call to 用户ID, 品类, 投放部门, 渠道, 渠道(中文), 部门, 组, h5id, h5归属人, 版位, 价格, 收集手机号, 链路类型-新, 投放账户id, 修正账号, 投放计划id, 投放素材id, 微信unionid, 手机号, 创建时间, 加微时间, 加微状态, 专栏id, 专栏名称, 期次值, 期次对应日期, 小鹅通ID, 是否填写问卷, 交易状态, 已领券, 用户状态, 销售id, 销售, AI销售SOP类型, 是否购买, 首次购买时间, 正价课订单数, 正价课GMV, 首次购买状态, 是否老用户, 是否老用户(30天内), D4正价课购买人数, D4正价课订单数, D4正价课GMV, D5正价课购买人数, D5正价课订单数, D5正价课GMV, D6正价课购买人数, D6正价课订单数, D6正价课GMV, D7正价课购买人数, D7正价课订单数, D7正价课GMV, D8正价课购买人数, D8正价课订单数, D8正价课GMV, D9正价课购买人数, D9正价课订单数, D9正价课GMV, D10正价课购买人数, D10正价课订单数, D10正价课GMV, D11正价课购买人数, D11正价课订单数, D11正价课GMV, D12正价课购买人数, D12正价课订单数, D12正价课GMV, D13正价课购买人数, D13正价课订单数, D13正价课GMV, D14正价课购买人数, D14正价课订单数, D14正价课GMV, 是否主动加微, 海外/国内, 国家编码, 太极兴趣度, 太极影响, 女性1：男性0, 45岁年龄以上, 手机型号, 地址, 是否来自于大城市（二线及以上）, IP所在省份, IP所在城市, 用户操作系统, 是否有效用户, 省份ISO编码.getDataType() on unbound object')
2025-08-13 09:27:27,132:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1458, in dispatch_request
    self.raise_routing_exception(req)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1440, in raise_routing_exception
    raise request.routing_exception  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/ctx.py", line 353, in match_request
    result = self.url_adapter.match(return_rule=True)  # type: ignore
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/routing/map.py", line 624, in match
    raise MethodNotAllowed(valid_methods=list(e.have_match_for)) from None
werkzeug.exceptions.MethodNotAllowed: 405 Method Not Allowed: The method is not allowed for the requested URL.
2025-08-13 09:28:17,589:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%%y%%m%%d'')')) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%%y%%m%%d'')')) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-13 09:28:17,611:WARNING:superset.connectors.sqla.models:Query SELECT substr(goods_name,2,6) AS `期次`, ad_department AS ad_department, sum(pay_sum_d4) AS `d4_GMV` 
FROM dws.dws_sale_camping_user_day INNER JOIN (SELECT ad_department AS ad_department__, sum(pay_sum_d4) AS mme_inner__ 
FROM dws.dws_sale_camping_user_day 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%%y%%m%%d'')')) GROUP BY ad_department ORDER BY mme_inner__ DESC 
 LIMIT 10) AS series_limit ON ad_department = ad_department__ 
WHERE ((期次 >= 'date_format(date_sub(current_date,interval 1 month),''%%y%%m%%d'')')) GROUP BY substr(goods_name,2,6), ad_department ORDER BY `d4_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column '期次' in 'table list' in FILTER clause")
2025-08-13 09:28:49,827:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 09:28:49,827:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 09:32:25,885:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 09:32:25,886:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 09:32:29,298:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/api/__init__.py", line 187, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/sqllab/api.py", line 342, in get_results
    result = SqlExecutionResultsCommand(key=key, rows=rows).run()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/sql_lab/results.py", line 105, in run
    self.validate()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/sql_lab/results.py", line 73, in validate
    raise SupersetErrorException(
superset.exceptions.SupersetErrorException: 无法从结果后端检索数据。您需要重新运行原始查询。
2025-08-13 09:32:31,833:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 09:32:31,844:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 09:32:31,845:INFO:superset.viz:Serving from cache
2025-08-13 09:50:03,815:INFO:superset.commands.sql_lab.execute:Triggering query_id: 22
2025-08-13 09:50:03,842:INFO:superset.sqllab.sql_json_executer:Query 22: Running query on a Celery worker
2025-08-13 09:50:18,096:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 09:50:18,096:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 09:50:19,610:WARNING:superset.connectors.sqla.models:Query SELECT `主键ID` AS `主键ID`, `用户ID` AS `用户ID`, `品类` AS `品类`, `投放部门` AS `投放部门`, `渠道` AS `渠道`, h5id AS h5id, `h5归属人` AS `h5归属人`, `版位` AS `版位`, `创建时间` AS `创建时间`, `加微时间` AS `加微时间`, `加微状态` AS `加微状态`, `专栏id` AS `专栏id`, `专栏名称` AS `专栏名称`, `小鹅通ID` AS `小鹅通ID`, `交易状态` AS `交易状态`, `用户状态` AS `用户状态`, `海外/国内` AS `海外/国内`, `国家编码` AS `国家编码`, `是否有效用户` AS `是否有效用户`, `是否老用户` AS `是否老用户`, `是否老用户__1` AS `是否老用户__1`, `太极兴趣度` AS `太极兴趣度`, `太极影响` AS `太极影响`, `性别` AS `性别`, `45岁年龄以上` AS `45岁年龄以上`, `二线及以上城市` AS `二线及以上城市`, `训练营重复次数` AS `训练营重复次数`, `流量来源-APP名称` AS `流量来源-APP名称`, `手机型号` AS `手机型号`, `历史总计销售发送信息数` AS `历史总计销售发送信息数`, `历史总计客户发送信息数` AS `历史总计客户发送信息数`, `历史总计信息回复率` AS `历史总计信息回复率`, `正价课购买次数` AS `正价课购买次数`, `历史总计正价课支付金额` AS `历史总计正价课支付金额`, `历史总计最大转化阶段` AS `历史总计最大转化阶段`, `地址` AS `地址`, `是否来自于大城市` AS `是否来自于大城市`, `工作` AS `工作`, `是否学过太极` AS `是否学过太极`, `太极基础` AS `太极基础`, `希望解决的问题` AS `希望解决的问题`, `学习目的` AS `学习目的`, `对课程了解程度和兴趣度` AS `对课程了解程度和兴趣度`, `现在健康情况是否影响生活` AS `现在健康情况是否影响生活`, `IP所在省份` AS `IP所在省份`, `IP所在城市` AS `IP所在城市`, `用户操作系统` AS `用户操作系统`, `省份ISO编码` AS `省份ISO编码` 
FROM (SELECT place_order_id                  `主键ID`
     , member_id                       `用户ID`
     , cat                             `品类`
     , ad_department                   `投放部门`
     , platform_name                   `渠道`
     , h5_id                           `h5id`
     , h5_owner_name                   `h5归属人`
     , pos                             `版位`
     , created_at                      `创建时间`
     , wx_add_time                     `加微时间`
     , wx_rel_status                   `加微状态`
     , special_id                      `专栏id`
     , goods_name                      `专栏名称`
     , xe_id                           `小鹅通ID`
     , trade_state                     `交易状态`
     , member_status                   `用户状态`
     , is_abroad                       `海外/国内`
     , country_code                    `国家编码`
     , is_effective_user               `是否有效用户`
     , is_old_user                     `是否老用户`
     , is_old_user_30                  `是否老用户`
     , interest                        `太极兴趣度`
     , influence                       `太极影响`
     , IF(sex = 1, '女', '男')         `性别`
     , age                             `45岁年龄以上`
     , city                            `二线及以上城市`
     , camping_repeat_time             `训练营重复次数`
     , app_name                        `流量来源-APP名称`
     , mobile_type                     `手机型号`
     , historical_sales_message_cnt    `历史总计销售发送信息数`
     , historical_customer_message_cnt `历史总计客户发送信息数`
     , historical_goods_message_rate   `历史总计信息回复率`
     , buy_time_cnt                    `正价课购买次数`
     , historical_payments             `历史总计正价课支付金额`
     , max_stage                       `历史总计最大转化阶段`
     , address                         `地址`
     , from_big_city                   `是否来自于大城市`
     , WORK                            `工作`
     , taiji_exp                       `是否学过太极`
     , taiji_basic                     `太极基础`
     , taiji_hope                      `希望解决的问题`
     , taiji_cause                     `学习目的`
     , taiji_interest                  `对课程了解程度和兴趣度`
     , taiji_influence                 `现在健康情况是否影响生活`
     , ip_province                     `IP所在省份`
     , ip_city                         `IP所在城市`
     , ip_os                           `用户操作系统`
     , province_iso_code               `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND d_date >= '2025-01-01'
) AS virtual_table 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Duplicated inline view column alias: '是否老用户' in inline view: 'virtual_table'")
2025-08-13 09:50:19,923:WARNING:superset.connectors.sqla.models:Query SELECT `主键ID` AS `主键ID`, `用户ID` AS `用户ID`, `品类` AS `品类`, `投放部门` AS `投放部门`, `渠道` AS `渠道`, h5id AS h5id, `h5归属人` AS `h5归属人`, `版位` AS `版位`, `创建时间` AS `创建时间`, `加微时间` AS `加微时间`, `加微状态` AS `加微状态`, `专栏id` AS `专栏id`, `专栏名称` AS `专栏名称`, `小鹅通ID` AS `小鹅通ID`, `交易状态` AS `交易状态`, `用户状态` AS `用户状态`, `海外/国内` AS `海外/国内`, `国家编码` AS `国家编码`, `是否有效用户` AS `是否有效用户`, `是否老用户` AS `是否老用户`, `是否老用户__1` AS `是否老用户__1`, `太极兴趣度` AS `太极兴趣度`, `太极影响` AS `太极影响`, `性别` AS `性别`, `45岁年龄以上` AS `45岁年龄以上`, `二线及以上城市` AS `二线及以上城市`, `训练营重复次数` AS `训练营重复次数`, `流量来源-APP名称` AS `流量来源-APP名称`, `手机型号` AS `手机型号`, `历史总计销售发送信息数` AS `历史总计销售发送信息数`, `历史总计客户发送信息数` AS `历史总计客户发送信息数`, `历史总计信息回复率` AS `历史总计信息回复率`, `正价课购买次数` AS `正价课购买次数`, `历史总计正价课支付金额` AS `历史总计正价课支付金额`, `历史总计最大转化阶段` AS `历史总计最大转化阶段`, `地址` AS `地址`, `是否来自于大城市` AS `是否来自于大城市`, `工作` AS `工作`, `是否学过太极` AS `是否学过太极`, `太极基础` AS `太极基础`, `希望解决的问题` AS `希望解决的问题`, `学习目的` AS `学习目的`, `对课程了解程度和兴趣度` AS `对课程了解程度和兴趣度`, `现在健康情况是否影响生活` AS `现在健康情况是否影响生活`, `IP所在省份` AS `IP所在省份`, `IP所在城市` AS `IP所在城市`, `用户操作系统` AS `用户操作系统`, `省份ISO编码` AS `省份ISO编码` 
FROM (SELECT place_order_id                  `主键ID`
     , member_id                       `用户ID`
     , cat                             `品类`
     , ad_department                   `投放部门`
     , platform_name                   `渠道`
     , h5_id                           `h5id`
     , h5_owner_name                   `h5归属人`
     , pos                             `版位`
     , created_at                      `创建时间`
     , wx_add_time                     `加微时间`
     , wx_rel_status                   `加微状态`
     , special_id                      `专栏id`
     , goods_name                      `专栏名称`
     , xe_id                           `小鹅通ID`
     , trade_state                     `交易状态`
     , member_status                   `用户状态`
     , is_abroad                       `海外/国内`
     , country_code                    `国家编码`
     , is_effective_user               `是否有效用户`
     , is_old_user                     `是否老用户`
     , is_old_user_30                  `是否老用户`
     , interest                        `太极兴趣度`
     , influence                       `太极影响`
     , IF(sex = 1, '女', '男')         `性别`
     , age                             `45岁年龄以上`
     , city                            `二线及以上城市`
     , camping_repeat_time             `训练营重复次数`
     , app_name                        `流量来源-APP名称`
     , mobile_type                     `手机型号`
     , historical_sales_message_cnt    `历史总计销售发送信息数`
     , historical_customer_message_cnt `历史总计客户发送信息数`
     , historical_goods_message_rate   `历史总计信息回复率`
     , buy_time_cnt                    `正价课购买次数`
     , historical_payments             `历史总计正价课支付金额`
     , max_stage                       `历史总计最大转化阶段`
     , address                         `地址`
     , from_big_city                   `是否来自于大城市`
     , WORK                            `工作`
     , taiji_exp                       `是否学过太极`
     , taiji_basic                     `太极基础`
     , taiji_hope                      `希望解决的问题`
     , taiji_cause                     `学习目的`
     , taiji_interest                  `对课程了解程度和兴趣度`
     , taiji_influence                 `现在健康情况是否影响生活`
     , ip_province                     `IP所在省份`
     , ip_city                         `IP所在城市`
     , ip_os                           `用户操作系统`
     , province_iso_code               `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND d_date >= '2025-01-01'
) AS virtual_table 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Duplicated inline view column alias: '是否老用户' in inline view: 'virtual_table'")
2025-08-13 09:50:52,392:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 10:05:53,594:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:05:53,605:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:05:53,607:INFO:superset.viz:Serving from cache
2025-08-13 10:06:07,500:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:06:07,512:INFO:superset.viz:Cache key: 4b87352186779372d443dec0c7679f6c
2025-08-13 10:06:23,519:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:06:23,520:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:08:44,521:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:08:44,531:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:08:44,533:INFO:superset.viz:Serving from cache
2025-08-13 10:09:14,486:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:09:14,496:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:09:14,497:INFO:superset.viz:Serving from cache
2025-08-13 10:09:29,361:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:09:29,362:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:10:58,453:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 10:14:00,942:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:14:00,953:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:14:00,955:INFO:superset.viz:Serving from cache
2025-08-13 10:14:31,278:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:14:31,287:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:14:31,288:INFO:superset.viz:Serving from cache
2025-08-13 10:14:36,772:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:14:36,781:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:14:36,782:INFO:superset.viz:Serving from cache
2025-08-13 10:15:01,228:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:15:01,238:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:15:01,240:INFO:superset.viz:Serving from cache
2025-08-13 10:18:35,533:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:18:35,544:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:18:35,546:INFO:superset.viz:Serving from cache
2025-08-13 10:19:22,705:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:19:22,706:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:19:35,631:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 151, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 302, in wrapper
    value = f(*args, add_extra_log_payload=log, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/core.py", line 790, in dashboard
    abort(404)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 277, in abort
    current_app.aborter(code, *args, **kwargs)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/exceptions.py", line 876, in __call__
    raise self.mapping[code](*args, **kwargs)
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 10:19:39,189:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:19:39,189:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:19:40,517:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/databases/api.py", line 1079, in table_extra_metadata
    raise DatabaseNotFoundException("No such database")
superset.exceptions.DatabaseNotFoundException: No such database
2025-08-13 10:19:42,488:WARNING:root:Failed to add user to db session: Class 'werkzeug.local.LocalProxy' is not mapped
2025-08-13 10:19:42,591:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:19:42,591:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:19:52,359:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/databases/api.py", line 1079, in table_extra_metadata
    raise DatabaseNotFoundException("No such database")
superset.exceptions.DatabaseNotFoundException: No such database
2025-08-13 10:19:55,364:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/databases/api.py", line 1079, in table_extra_metadata
    raise DatabaseNotFoundException("No such database")
superset.exceptions.DatabaseNotFoundException: No such database
2025-08-13 10:20:21,559:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:20:21,570:INFO:superset.viz:Cache key: b399bdf55ca87c603ff86e1c565a4246
2025-08-13 10:20:21,649:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-13 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `期次值`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:21,696:WARNING:superset.connectors.sqla.models:Query SELECT `省份ISO编码` AS `省份ISO编码`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `省份ISO编码` 
 LIMIT 50000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:21,765:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(D8正价课GMV) AS `D8_GMV` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-13 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `期次值`, `投放部门` ORDER BY `D8_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:21,766:WARNING:superset.connectors.sqla.models:Query SELECT `用户操作系统` AS `用户操作系统`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `用户操作系统` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:21,855:WARNING:superset.connectors.sqla.models:Query SELECT `链路类型-新` AS `链路类型-新`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `链路类型-新` 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:22,104:WARNING:superset.connectors.sqla.models:Query SELECT `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE (ad_department='信息流一部') AND (cat='太极') GROUP BY `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:22,126:WARNING:superset.connectors.sqla.models:Query SELECT `品类` AS `品类`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE (ad_department='信息流一部') AND (cat='太极') GROUP BY `品类` ORDER BY `有效例子数` DESC 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:47,859:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:20:47,860:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:20:48,857:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:20:48,867:INFO:superset.viz:Cache key: b399bdf55ca87c603ff86e1c565a4246
2025-08-13 10:20:48,870:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-13 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `期次值`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:48,937:WARNING:superset.connectors.sqla.models:Query SELECT `用户操作系统` AS `用户操作系统`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `用户操作系统` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:48,991:WARNING:superset.connectors.sqla.models:Query SELECT `省份ISO编码` AS `省份ISO编码`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `省份ISO编码` 
 LIMIT 50000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:49,003:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(D8正价课GMV) AS `D8_GMV` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-13 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `期次值`, `投放部门` ORDER BY `D8_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:49,094:WARNING:superset.connectors.sqla.models:Query SELECT `链路类型-新` AS `链路类型-新`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (ad_department='信息流一部') AND (cat='太极') GROUP BY `链路类型-新` 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:49,268:WARNING:superset.connectors.sqla.models:Query SELECT `品类` AS `品类`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE (ad_department='信息流一部') AND (cat='太极') GROUP BY `品类` ORDER BY `有效例子数` DESC 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:49,294:WARNING:superset.connectors.sqla.models:Query SELECT `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE (ad_department='信息流一部') AND (cat='太极') GROUP BY `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'ad_department' in 'table list' in FILTER clause")
2025-08-13 10:20:54,759:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 10:21:06,733:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:21:06,733:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:21:32,010:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:21:32,023:INFO:superset.viz:Cache key: 376d71fe02084d973f9ba606d65e409a
2025-08-13 10:21:32,101:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-13 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `期次值`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:32,140:WARNING:superset.connectors.sqla.models:Query SELECT `省份ISO编码` AS `省份ISO编码`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `省份ISO编码` 
 LIMIT 50000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:32,216:WARNING:superset.connectors.sqla.models:Query SELECT `期次值` AS `期次值`, `投放部门` AS `投放部门`, sum(D8正价课GMV) AS `D8_GMV` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-07-13 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `期次值`, `投放部门` ORDER BY `D8_GMV` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:32,221:WARNING:superset.connectors.sqla.models:Query SELECT `用户操作系统` AS `用户操作系统`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `用户操作系统` ORDER BY `有效例子数` DESC 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:32,324:WARNING:superset.connectors.sqla.models:Query SELECT `链路类型-新` AS `链路类型-新`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE `期次对应日期` >= '2025-08-06 00:00:00.000000' AND `期次对应日期` < '2025-08-13 00:00:00.000000' AND (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `链路类型-新` 
 LIMIT 100 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:32,494:WARNING:superset.connectors.sqla.models:Query SELECT `品类` AS `品类`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `品类` ORDER BY `有效例子数` DESC 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:32,499:WARNING:superset.connectors.sqla.models:Query SELECT `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT member_id         AS `用户ID`
     , cat               AS `品类`
     , ad_department     AS `投放部门`
     , platform          AS `渠道`
     , platform_name     AS `渠道(中文)`
     , department        AS `部门`
     , user_group        AS `组`
     , h5_id             AS `h5id`
     , h5_owner_name     AS `h5归属人`
     , pos               AS `版位`
     , price             AS `价格`
     , mobile            AS `收集手机号`
     , link_type_v2      AS `链路类型-新`
     , cost_id           AS `投放账户id`
     , cost_id2          AS `修正账号`
     , ad_id             AS `投放计划id`
     , sucai_id          AS `投放素材id`
     , unionid           AS `微信unionid`
     , phone             AS `手机号`
     , created_at        AS `创建时间`
     , wx_add_time       AS `加微时间`
     , wx_rel_status     AS `加微状态`
     , special_id        AS `专栏id`
     , goods_name        AS `专栏名称`
     ,substr(goods_name,2,6) as `期次值`
     ,date_format(concat('20', substr(goods_name, 2, 2), '-', substr(goods_name, 4, 2), '-', substr(goods_name, 6, 2)), 'yyyy-MM-dd') as `期次对应日期`
     , xe_id             AS `小鹅通ID`
     , ifcollect         AS `是否填写问卷`
     , trade_state       AS `交易状态`
     , is_get_ticket     AS `已领券`
     , member_status     AS `用户状态`
     , sales_id          AS `销售id`
     , sales_name        AS `销售`
     , sales_sop_type    AS `AI销售SOP类型`
     , ifbuy             AS `是否购买`
     , first_pay_time    AS `首次购买时间`
     , pay_num           AS `正价课订单数`
     , pay_sum           AS `正价课GMV`
     , first_order_state AS `首次购买状态`
     , is_old_user       AS `是否老用户`
     , is_old_user_30    AS `是否老用户(30天内)`
     , pay_user_num_d4   AS `D4正价课购买人数`
     , pay_num_d4        AS `D4正价课订单数`
     , pay_sum_d4        AS `D4正价课GMV`
     , pay_user_num_d5   AS `D5正价课购买人数`
     , pay_num_d5        AS `D5正价课订单数`
     , pay_sum_d5        AS `D5正价课GMV`
     , pay_user_num_d6   AS `D6正价课购买人数`
     , pay_num_d6        AS `D6正价课订单数`
     , pay_sum_d6        AS `D6正价课GMV`
     , pay_user_num_d7   AS `D7正价课购买人数`
     , pay_num_d7        AS `D7正价课订单数`
     , pay_sum_d7        AS `D7正价课GMV`
     , pay_user_num_d8   AS `D8正价课购买人数`
     , pay_num_d8        AS `D8正价课订单数`
     , pay_sum_d8        AS `D8正价课GMV`
     , pay_user_num_d9   AS `D9正价课购买人数`
     , pay_num_d9        AS `D9正价课订单数`
     , pay_sum_d9        AS `D9正价课GMV`
     , pay_user_num_d10  AS `D10正价课购买人数`
     , pay_num_d10       AS `D10正价课订单数`
     , pay_sum_d10       AS `D10正价课GMV`
     , pay_user_num_d11  AS `D11正价课购买人数`
     , pay_num_d11       AS `D11正价课订单数`
     , pay_sum_d11       AS `D11正价课GMV`
     , pay_user_num_d12  AS `D12正价课购买人数`
     , pay_num_d12       AS `D12正价课订单数`
     , pay_sum_d12       AS `D12正价课GMV`
     , pay_user_num_d13  AS `D13正价课购买人数`
     , pay_num_d13       AS `D13正价课订单数`
     , pay_sum_d13       AS `D13正价课GMV`
     , pay_user_num_d14  AS `D14正价课购买人数`
     , pay_num_d14       AS `D14正价课订单数`
     , pay_sum_d14       AS `D14正价课GMV`
     , wx_active         AS `是否主动加微`
     , is_abroad         AS `海外/国内`
     , country_code      AS `国家编码`
     , interest          AS `太极兴趣度`
     , influence         AS `太极影响`
     , sex               AS `女性1：男性0`
     , age               AS `45岁年龄以上`
     , mobile_type       AS `手机型号`
     , address           AS `地址`
     , from_big_city     AS `是否来自于大城市（二线及以上）`
     , ip_province       AS `IP所在省份`
     , ip_city           AS `IP所在城市`
     , ip_os             AS `用户操作系统`
     , is_effective_user AS `是否有效用户`
     , province_iso_code AS `省份ISO编码`
FROM dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
) AS virtual_table 
WHERE (`投放部门`='信息流一部') AND (cat='太极') GROUP BY `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 1000 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Unknown column 'cat' in 'table list' in FILTER clause")
2025-08-13 10:21:55,635:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:21:55,636:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:22:08,678:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:22:08,679:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:22:09,958:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:22:09,971:INFO:superset.viz:Cache key: f94dcbfd245e6b6ad4c1cb012f2f3b70
2025-08-13 10:22:15,653:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/databases/api.py", line 1079, in table_extra_metadata
    raise DatabaseNotFoundException("No such database")
superset.exceptions.DatabaseNotFoundException: No such database
2025-08-13 10:22:21,138:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:22:21,149:INFO:superset.viz:Cache key: f94dcbfd245e6b6ad4c1cb012f2f3b70
2025-08-13 10:22:21,150:INFO:superset.viz:Serving from cache
2025-08-13 10:23:11,574:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:23:11,585:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:23:11,588:INFO:superset.viz:Serving from cache
2025-08-13 10:23:55,170:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:23:55,184:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:23:55,186:INFO:superset.viz:Serving from cache
2025-08-13 10:23:55,366:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:23:55,375:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 10:23:55,376:INFO:superset.viz:Serving from cache
2025-08-13 10:23:55,586:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:23:55,596:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 10:24:11,756:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:24:11,770:INFO:superset.viz:Cache key: 803a673d2157a5a305c07f32a92230b8
2025-08-13 10:24:23,787:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 10:25:30,209:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:25:30,221:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 10:25:30,222:INFO:superset.viz:Serving from cache
2025-08-13 10:31:55,309:INFO:superset.commands.sql_lab.execute:Triggering query_id: 23
2025-08-13 10:31:55,335:INFO:superset.sqllab.sql_json_executer:Query 23: Running query on a Celery worker
2025-08-13 10:32:00,533:INFO:superset.commands.sql_lab.execute:Triggering query_id: 24
2025-08-13 10:32:00,558:INFO:superset.sqllab.sql_json_executer:Query 24: Running query on a Celery worker
2025-08-13 10:32:13,771:INFO:superset.commands.sql_lab.execute:Triggering query_id: 25
2025-08-13 10:32:13,795:INFO:superset.sqllab.sql_json_executer:Query 25: Running query on a Celery worker
2025-08-13 10:32:19,149:INFO:superset.commands.sql_lab.execute:Triggering query_id: 26
2025-08-13 10:32:19,173:INFO:superset.sqllab.sql_json_executer:Query 26: Running query on a Celery worker
2025-08-13 10:32:40,094:INFO:superset.commands.sql_lab.execute:Triggering query_id: 27
2025-08-13 10:32:40,117:INFO:superset.sqllab.sql_json_executer:Query 27: Running query on a Celery worker
2025-08-13 10:32:52,748:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:32:52,748:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:34:29,540:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 10:48:08,465:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:48:08,483:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 10:48:08,485:INFO:superset.viz:Serving from cache
2025-08-13 10:48:59,236:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 10:48:59,248:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 10:48:59,250:INFO:superset.viz:Serving from cache
2025-08-13 10:58:51,176:INFO:superset.commands.sql_lab.execute:Triggering query_id: 28
2025-08-13 10:58:51,223:INFO:superset.sqllab.sql_json_executer:Query 28: Running query on a Celery worker
2025-08-13 10:59:06,157:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 10:59:06,157:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 10:59:07,593:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1664, in get_sqla_query
    selected = validate_adhoc_subquery(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 137, in validate_adhoc_subquery
    raise SupersetSecurityException(
superset.exceptions.SupersetSecurityException: Custom SQL fields cannot contain sub-queries.
2025-08-13 10:59:07,804:WARNING:superset.views.error_handling:SupersetErrorException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 189, in _get_results
    payload = _get_full(query_context, query_obj, force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1664, in get_sqla_query
    selected = validate_adhoc_subquery(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 137, in validate_adhoc_subquery
    raise SupersetSecurityException(
superset.exceptions.SupersetSecurityException: Custom SQL fields cannot contain sub-queries.
2025-08-13 10:59:17,029:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 11:09:15,113:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:09:15,125:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:09:15,126:INFO:superset.viz:Serving from cache
2025-08-13 11:10:21,161:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:10:21,172:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:10:21,173:INFO:superset.viz:Serving from cache
2025-08-13 11:11:05,660:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:11:05,674:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:11:05,676:INFO:superset.viz:Serving from cache
2025-08-13 11:12:01,816:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:12:01,826:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:12:01,828:INFO:superset.viz:Serving from cache
2025-08-13 11:12:01,928:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:12:01,939:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:12:01,940:INFO:superset.viz:Serving from cache
2025-08-13 11:12:07,166:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:12:07,180:INFO:superset.viz:Cache key: c80ddca63e5041cc673feb8e84f5da25
2025-08-13 11:12:43,491:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 11:12:43,491:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 11:12:44,599:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:12:44,610:INFO:superset.viz:Cache key: c80ddca63e5041cc673feb8e84f5da25
2025-08-13 11:12:44,611:INFO:superset.viz:Serving from cache
2025-08-13 11:12:49,284:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:12:49,295:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:12:49,297:INFO:superset.viz:Serving from cache
2025-08-13 11:12:52,185:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:12:52,199:INFO:superset.viz:Cache key: 29c9d3c5baacab82028ab75d46bb0720
2025-08-13 11:27:17,333:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:27:17,345:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:27:17,347:INFO:superset.viz:Serving from cache
2025-08-13 11:27:36,228:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:27:36,240:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:27:36,242:INFO:superset.viz:Serving from cache
2025-08-13 11:29:43,213:WARNING:superset.views.error_handling:SupersetSecurityException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/error_handling.py", line 101, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/views.py", line 203, in samples
    rv = get_samples(
         ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/datasource/utils.py", line 113, in get_samples
    sample_data = samples_instance.get_payload()["queries"][0]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 183, in _get_drill_detail
    return _get_full(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1664, in get_sqla_query
    selected = validate_adhoc_subquery(
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 137, in validate_adhoc_subquery
    raise SupersetSecurityException(
superset.exceptions.SupersetSecurityException: Custom SQL fields cannot contain sub-queries.
2025-08-13 11:34:39,989:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:34:40,000:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:34:40,002:INFO:superset.viz:Serving from cache
2025-08-13 11:35:03,796:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:35:03,808:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:35:03,810:INFO:superset.viz:Serving from cache
2025-08-13 11:39:16,191:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:39:16,203:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:39:16,205:INFO:superset.viz:Serving from cache
2025-08-13 11:39:34,593:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:39:34,604:INFO:superset.viz:Cache key: 803a673d2157a5a305c07f32a92230b8
2025-08-13 11:39:34,606:INFO:superset.viz:Serving from cache
2025-08-13 11:39:59,909:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:39:59,919:INFO:superset.viz:Cache key: 5ec90a0a57f992519247b1515b150e05
2025-08-13 11:41:00,099:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:00,109:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:41:00,112:INFO:superset.viz:Serving from cache
2025-08-13 11:41:11,265:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:11,277:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:41:11,279:INFO:superset.viz:Serving from cache
2025-08-13 11:41:11,406:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:11,419:INFO:superset.viz:Cache key: abdfd5da5371a901429b0f4267b27b21
2025-08-13 11:41:11,421:INFO:superset.viz:Serving from cache
2025-08-13 11:41:11,717:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:11,728:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 11:41:22,790:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:22,801:INFO:superset.viz:Cache key: 891e3d168d51b9bf07547ca7121d5614
2025-08-13 11:41:22,802:INFO:superset.viz:Serving from cache
2025-08-13 11:41:22,976:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:22,986:INFO:superset.viz:Cache key: 5ec90a0a57f992519247b1515b150e05
2025-08-13 11:41:22,987:INFO:superset.viz:Serving from cache
2025-08-13 11:41:40,567:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 11:41:40,580:INFO:superset.viz:Cache key: ddb525d5c05127427e2e6982cebb9734
2025-08-13 11:43:09,032:WARNING:superset.views.error_handling:HTTPException
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 502, in <lambda>
    view_func=lambda **kw: self_ref().send_static_file(**kw),  # type: ignore # noqa: B950
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/scaffold.py", line 317, in send_static_file
    return send_from_directory(
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/helpers.py", line 557, in send_from_directory
    return werkzeug.utils.send_from_directory(  # type: ignore[return-value]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/werkzeug/utils.py", line 575, in send_from_directory
    raise NotFound()
werkzeug.exceptions.NotFound: 404 Not Found: The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
2025-08-13 12:01:25,886:WARNING:superset.connectors.sqla.models:Query SELECT `转化阶段` AS `转化阶段`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table INNER JOIN (SELECT `投放部门` AS `投放部门__`, sum(是否有效用户) AS mme_inner__ 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table GROUP BY `投放部门` ORDER BY mme_inner__ DESC 
 LIMIT 25) AS series_limit ON `投放部门` = `投放部门__` GROUP BY `转化阶段`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 50 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Duplicated inline view column alias: '是否老用户' in inline view: 'virtual_table'")
2025-08-13 12:01:25,886:WARNING:superset.connectors.sqla.models:Query SELECT `转化阶段` AS `转化阶段`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table INNER JOIN (SELECT `投放部门` AS `投放部门__`, sum(是否有效用户) AS mme_inner__ 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table GROUP BY `投放部门` ORDER BY mme_inner__ DESC 
 LIMIT 25) AS series_limit ON `投放部门` = `投放部门__` GROUP BY `转化阶段`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 50 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Duplicated inline view column alias: '是否老用户' in inline view: 'virtual_table'")
2025-08-13 12:01:26,482:WARNING:superset.connectors.sqla.models:Query SELECT `转化阶段` AS `转化阶段`, `投放部门` AS `投放部门`, sum(`正价课GMV`) AS `SUM(正价课GMV)` 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table INNER JOIN (SELECT `投放部门` AS `投放部门__`, sum(`正价课GMV`) AS mme_inner__ 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table GROUP BY `投放部门` ORDER BY mme_inner__ DESC 
 LIMIT 25) AS series_limit ON `投放部门` = `投放部门__` GROUP BY `转化阶段`, `投放部门` ORDER BY `SUM(正价课GMV)` DESC 
 LIMIT 50 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Duplicated inline view column alias: '是否老用户' in inline view: 'virtual_table'")
2025-08-13 12:01:26,815:WARNING:superset.connectors.sqla.models:Query SELECT `转化阶段` AS `转化阶段`, `投放部门` AS `投放部门`, sum(`正价课GMV`) AS `SUM(正价课GMV)` 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table INNER JOIN (SELECT `投放部门` AS `投放部门__`, sum(`正价课GMV`) AS mme_inner__ 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`

     , is_old_user                                       AS                                  `是否老用户`
     , is_old_user_30                                    AS                                  `是否老用户(30天内)`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table GROUP BY `投放部门` ORDER BY mme_inner__ DESC 
 LIMIT 25) AS series_limit ON `投放部门` = `投放部门__` GROUP BY `转化阶段`, `投放部门` ORDER BY `SUM(正价课GMV)` DESC 
 LIMIT 50 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, "errCode = 2, detailMessage = Duplicated inline view column alias: '是否老用户' in inline view: 'virtual_table'")
2025-08-13 12:02:33,491:WARNING:superset.connectors.sqla.models:Query SELECT `转化阶段` AS `转化阶段`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table INNER JOIN (SELECT `投放部门` AS `投放部门__`, sum(是否有效用户) AS mme_inner__ 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table GROUP BY `投放部门` ORDER BY mme_inner__ DESC 
 LIMIT 25) AS series_limit ON `投放部门` = `投放部门__` GROUP BY `转化阶段`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 50 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = sum requires a numeric or boolean parameter: sum(是否有效用户)')
2025-08-13 12:02:35,688:WARNING:superset.connectors.sqla.models:Query SELECT `转化阶段` AS `转化阶段`, `投放部门` AS `投放部门`, sum(是否有效用户) AS `有效例子数` 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table INNER JOIN (SELECT `投放部门` AS `投放部门__`, sum(是否有效用户) AS mme_inner__ 
FROM (SELECT place_order_id                                    AS                                  `主键字段`
     , member_id                                         AS                                  `用户ID`
     , cat                                               AS                                  `品类`
     , ad_department                                     AS                                  `投放部门`
     , platform_name                                     AS                                  `渠道`
     , h5_id                                             AS                                  `h5id`
     , h5_owner_name                                     AS                                  `h5归属人`
     , pos                                               AS                                  `版位`
     , created_at                                        AS                                  `创建时间`
     , wx_add_time                                       AS                                  `加微时间`
     , wx_rel_status                                     AS                                  `加微状态`
     , special_id                                        AS                                  `专栏id`
     , goods_name                                        AS                                  `专栏名称`
     , SUBSTR(goods_name, 2, 6)                          AS                                  `期次值`
     , DATE_FORMAT(CONCAT('20', SUBSTR(goods_name, 2, 2), '-', SUBSTR(goods_name, 4, 2), '-', SUBSTR(goods_name, 6, 2)),
                   'yyyy-MM-dd')                         AS                                  `期次对应日期`
     , xe_id                                             AS                                  `小鹅通ID`
     , trade_state                                       AS                                  `交易状态`
     , member_status                                     AS                                  `用户状态`
     , is_abroad                                         AS                                  `海外/国内`
     , country_code                                      AS                                  `国家编码`
     , IF(is_effective_user = 1, '有效例子', '无效例子') AS                                  `是否有效用户`

     -- 投放属性
     , cost_id                                           AS                                  `投放账户id`
     , ad_id                                             AS                                  `投放计划id`
     , sucai_id                                          AS                                  `投放素材id`

     -- 销售属性
     , department                                        AS                                  `销售部门`
     , user_group                                        AS                                  `销售组`
     , sales_id                                          AS                                  `销售id`
     , sales_name                                        AS                                  `销售`
     , sales_sop_type                                    AS                                  `AI销售SOP类型`
     , process_type                                      AS                                  `是否AI全流程 1:全流程 0：正常流程`
     , is_sales_assign_order                             AS                                  `是否销售派单 1:是 0：否`

     -- 链路属性
     , price                                             AS                                  `价格`
     , mobile                                            AS                                  `是否收集手机号`
     , link_type_v2                                      AS                                  `链路类型-新`
     -- 转化属性
     , ifbuy                                             AS                                  `是否购买`
     , CASE
           WHEN pay_num_d1 = 1 THEN 'D1'
           WHEN pay_num_d2 = 1 THEN 'D2'
           WHEN pay_num_d3 = 1 THEN 'D3'
           WHEN pay_num_d4 = 1 THEN 'D4'
           WHEN pay_num_d5 = 1 THEN 'D5'
           WHEN pay_num_d6 = 1 THEN 'D6'
           WHEN pay_num_d7 = 1 THEN 'D7'
           WHEN pay_num_d8 = 1 THEN 'D8'
           ELSE 'D8后'
    END                                                  AS                                  `转化阶段`
     , first_pay_time                                    AS                                  `首次购买时间`
     , pay_num                                           AS                                  `正价课订单数`
     , pay_sum                                           AS                                  `正价课GMV`
     , pay_user_num_d1                                   AS                                  `D1正价课购买人数`
     , pay_num_d1                                        AS                                  `D1正价课订单数`
     , pay_sum_d1                                        AS                                  `D1正价课GMV`
     , pay_user_num_d2                                   AS                                  `D2正价课购买人数`
     , pay_num_d2                                        AS                                  `D2正价课订单数`
     , pay_sum_d2                                        AS                                  `D2正价课GMV`
     , pay_user_num_d3                                   AS                                  `D3正价课购买人数`
     , pay_num_d3                                        AS                                  `D3正价课订单数`
     , pay_sum_d3                                        AS                                  `D3正价课GMV`
     , pay_user_num_d4                                   AS                                  `D4正价课购买人数`
     , pay_num_d4                                        AS                                  `D4正价课订单数`
     , pay_sum_d4                                        AS                                  `D4正价课GMV`
     , pay_user_num_d4_24h                               AS                                  `D4正价课购买人数(24H)`
     , pay_num_d4_24h                                    AS                                  `D4正价课订单数(24H)`
     , pay_sum_d4_24h                                    AS                                  `D4正价课GMV(24H)`
     , pay_user_num_d5                                   AS                                  `D5正价课购买人数`
     , pay_num_d5                                        AS                                  `D5正价课订单数`
     , pay_sum_d5                                        AS                                  `D5正价课GMV`
     , pay_user_num_d6                                   AS                                  `D6正价课购买人数`
     , pay_num_d6                                        AS                                  `D6正价课订单数`
     , pay_sum_d6                                        AS                                  `D6正价课GMV`
     , pay_user_num_d7                                   AS                                  `D7正价课购买人数`
     , pay_num_d7                                        AS                                  `D7正价课订单数`
     , pay_sum_d7                                        AS                                  `D7正价课GMV`
     , pay_user_num_d8                                   AS                                  `D8正价课购买人数`
     , pay_num_d8                                        AS                                  `D8正价课订单数`
     , pay_sum_d8                                        AS                                  `D8正价课GMV`
     , pay_user_num_d9                                   AS                                  `D9正价课购买人数`
     , pay_num_d9                                        AS                                  `D9正价课订单数`
     , pay_sum_d9                                        AS                                  `D9正价课GMV`
     , pay_user_num_d10                                  AS                                  `D10正价课购买人数`
     , pay_num_d10                                       AS                                  `D10正价课订单数`
     , pay_sum_d10                                       AS                                  `D10正价课GMV`
     , pay_user_num_d11                                  AS                                  `D11正价课购买人数`
     , pay_num_d11                                       AS                                  `D11正价课订单数`
     , pay_sum_d11                                       AS                                  `D11正价课GMV`
     , pay_user_num_d12                                  AS                                  `D12正价课购买人数`
     , pay_num_d12                                       AS                                  `D12正价课订单数`
     , pay_sum_d12                                       AS                                  `D12正价课GMV`
     , pay_user_num_d13                                  AS                                  `D13正价课购买人数`
     , pay_num_d13                                       AS                                  `D13正价课订单数`
     , pay_sum_d13                                       AS                                  `D13正价课GMV`
     , pay_user_num_d14                                  AS                                  `D14正价课购买人数`
     , pay_num_d14                                       AS                                  `D14正价课订单数`
     , pay_sum_d14                                       AS                                  `D14正价课GMV`

-- 行为数据
     , CASE
           WHEN current_class_time = 0 THEN 0
           WHEN current_class_time <= 600 THEN '10分钟以下'
           WHEN current_class_time <= 3600 THEN '1小时以下'
           WHEN current_class_time <= 10800 THEN '3小时以下'
           WHEN current_class_time <= 36000 THEN '10小时以下'
           WHEN current_class_time <= 108000 THEN '30小时以下'
           WHEN current_class_time <= 360000 THEN '100小时以下'
           WHEN current_class_time > 360000 THEN '100小时以上'
           ELSE 0 END                                    AS                                  `上课时长区间`
     , ifcollect                                         AS                                  `是否填写问卷`
     , is_get_ticket                                     AS                                  `已领券`
     , ifcome0                                           AS                                  `D0是否到课`
     , ifok0                                             AS                                  `D0是否完课`
     , ifcome1                                           AS                                  `D1是否到课`
     , ifok1                                             AS                                  `D1是否完课`
     , ifcome2                                           AS                                  `D2是否到课`
     , ifok2                                             AS                                  `D2是否完课`
     , ifcome3                                           AS                                  `D3是否到课`
     , ifok3                                             AS                                  `D3是否完课`
     , ifcome4                                           AS                                  `D4是否到课`
     , ifok4                                             AS                                  `D4是否完课`
     , ifcome5                                           AS                                  `D5是否到课`
     , ifok5                                             AS                                  `D5是否完课`
     , wx_active                                         AS                                  `是否主动加微`
     , collect_active                                    AS                                  `是否主动问卷`
     , current_class_time                                AS                                  `当前期次上课时长（秒）`
     , historical_class_time                             AS                                  `历史总计上课时长（秒）`
     , last_communication_time                           AS                                  `上次沟通时间`
     , sales_message_cnt                                 AS                                  `当前期次销售发送信息数（条）`
     , customer_message_cnt                              AS                                  `当前期次客户发送信息数（条）`
     , current_goods_message_rate                        AS                                  `当前期次信息回复率（本期次客户信息数/销售信息数）`
     , d4_all_homework                                   AS                                  `D4提交作业次数`
     , d7_all_homework                                   AS                                  `D7提交作业次数`
     , d0_homework                                       AS                                  `D0是否交作业`
     , d1_homework                                       AS                                  `D1是否交作业`
     , d2_homework                                       AS                                  `D2是否交作业`
     , d3_homework                                       AS                                  `D3是否交作业`
     , d4_homework                                       AS                                  `D4是否交作业`
     , d5_homework                                       AS                                  `D5是否交作业`
     , d6_homework                                       AS                                  `D6是否交作业`
     , d7_homework                                       AS                                  `D7是否交作业`


-- 画像数据
     , IF(is_old_user = 1, IF(is_old_user_30 = 1, '30天内重复例子', '重复例子'), '正常例子') `是否老用户`
     , interest                                          AS                                  `太极兴趣度`
     , influence                                         AS                                  `太极影响`
     , IF(sex = 1, '女', '男')                                                               `性别`
     , age                                               AS                                  `45岁年龄以上`
     , city                                              AS                                  `二线及以上城市`
     , camping_repeat_time                               AS                                  `训练营重复次数`
     , app_name                                          AS                                  `流量来源-APP名称`
     , mobile_type                                       AS                                  `手机型号`
     , historical_sales_message_cnt                      AS                                  `历史总计销售发送信息数（条）`
     , historical_customer_message_cnt                   AS                                  `历史总计客户发送信息数（条）`
     , historical_goods_message_rate                     AS                                  `历史总计信息回复率（历史总计客户信息数/销售信息数）`
     , buy_time_cnt                                      AS                                  `正价课购买次数`
     , historical_payments                               AS                                  `历史总计正价课支付金额（元）`
     , max_stage                                         AS                                  `历史总计最大转化阶段`
     , address                                           AS                                  `地址`
     , from_big_city                                     AS                                  `是否来自于大城市（二线及以上）`
     , work                                              AS                                  `工作`
     , taiji_exp                                         AS                                  `是否学过太极`
     , taiji_basic                                       AS                                  `太极基础`
     , taiji_hope                                        AS                                  `希望解决的问题`
     , taiji_cause                                       AS                                  `学习目的`
     , taiji_interest                                    AS                                  `对课程了解程度和兴趣度`
     , taiji_influence                                   AS                                  `现在健康情况是否影响生活`
     , ip_province                                       AS                                  `IP所在省份`
     , ip_city                                           AS                                  `IP所在城市`
     , ip_os                                             AS                                  `用户操作系统`
     , province_iso_code                                 AS                                  `省份ISO编码`
FROM wuhan_hive.dws.dws_sale_camping_user_day
WHERE dt = DATE_SUB(CURRENT_DATE, INTERVAL 1 DAY)
  AND created_at >= '2025-01-01 00:00:00'
) AS virtual_table GROUP BY `投放部门` ORDER BY mme_inner__ DESC 
 LIMIT 25) AS series_limit ON `投放部门` = `投放部门__` GROUP BY `转化阶段`, `投放部门` ORDER BY `有效例子数` DESC 
 LIMIT 50 on schema dws failed
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1748, in query
    df = self.database.get_df(
         ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/core.py", line 706, in get_df
    self.db_engine_spec.execute(cursor, sql_, self)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1868, in execute
    raise cls.get_dbapi_mapped_exception(ex) from ex
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/db_engine_specs/base.py", line 1864, in execute
    cursor.execute(query)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 153, in execute
    result = self._query(query)
             ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/cursors.py", line 322, in _query
    conn.query(q)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 563, in query
    self._affected_rows = self._read_query_result(unbuffered=unbuffered)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 825, in _read_query_result
    result.read()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 1199, in read
    first_packet = self.connection._read_packet()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/connections.py", line 775, in _read_packet
    packet.raise_for_error()
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/protocol.py", line 219, in raise_for_error
    err.raise_mysql_exception(self._data)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/pymysql/err.py", line 150, in raise_mysql_exception
    raise errorclass(errno, errval)
pymysql.err.OperationalError: (1105, 'errCode = 2, detailMessage = sum requires a numeric or boolean parameter: sum(是否有效用户)')
2025-08-13 12:05:15,258:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:05:15,270:INFO:superset.viz:Cache key: 8cfbeba8b0801524f4711b7cb0ab0303
2025-08-13 12:12:02,864:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:12:02,874:INFO:superset.viz:Cache key: 8cfbeba8b0801524f4711b7cb0ab0303
2025-08-13 12:12:42,064:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:12:42,074:INFO:superset.viz:Cache key: 8cfbeba8b0801524f4711b7cb0ab0303
2025-08-13 12:16:02,477:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:02,487:INFO:superset.viz:Cache key: 8cfbeba8b0801524f4711b7cb0ab0303
2025-08-13 12:16:22,824:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:22,835:INFO:superset.viz:Cache key: 8cfbeba8b0801524f4711b7cb0ab0303
2025-08-13 12:16:23,009:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:23,021:INFO:superset.viz:Cache key: 8cfbeba8b0801524f4711b7cb0ab0303
2025-08-13 12:16:23,278:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:23,289:INFO:superset.viz:Cache key: e3b88fd8dd04942aa4aefbb9019d5f2c
2025-08-13 12:16:25,189:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 12:16:25,190:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 12:16:26,647:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:26,659:INFO:superset.viz:Cache key: e3b88fd8dd04942aa4aefbb9019d5f2c
2025-08-13 12:16:36,831:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:36,841:INFO:superset.viz:Cache key: 9d226c0d07f7f3d3b05235c80382700c
2025-08-13 12:16:52,709:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:52,719:INFO:superset.viz:Cache key: e3b88fd8dd04942aa4aefbb9019d5f2c
2025-08-13 12:16:52,882:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:16:52,892:INFO:superset.viz:Cache key: e3b88fd8dd04942aa4aefbb9019d5f2c
2025-08-13 12:17:07,949:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:17:07,950:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:17:07,959:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:17:07,960:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:17:12,112:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:17:12,113:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:17:12,115:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:17:12,124:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:17:12,126:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:17:12,126:INFO:superset.viz:Serving from cache
2025-08-13 12:17:12,127:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:17:12,128:INFO:superset.viz:Serving from cache
2025-08-13 12:17:12,129:INFO:superset.viz:Serving from cache
2025-08-13 12:17:50,998:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:17:51,009:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:17:51,012:INFO:superset.viz:Serving from cache
2025-08-13 12:18:01,071:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:18:01,083:INFO:superset.viz:Cache key: b8121d3414026be60fe18213f1762ecb
2025-08-13 12:45:26,368:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:45:26,378:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:45:26,380:INFO:superset.viz:Serving from cache
2025-08-13 12:45:36,158:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:45:36,171:INFO:superset.viz:Cache key: 4a5fdb6e105d2af191dbc9eba08d8879
2025-08-13 12:46:12,325:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:46:12,336:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:46:12,339:INFO:superset.viz:Serving from cache
2025-08-13 12:46:18,562:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:46:18,573:INFO:superset.viz:Cache key: b9f52a9bd0c43d019e691a5eb3ae5b8a
2025-08-13 12:47:08,025:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:47:08,036:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:47:08,038:INFO:superset.viz:Serving from cache
2025-08-13 12:47:29,873:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 12:47:29,874:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 12:47:31,300:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:47:31,310:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:47:31,311:INFO:superset.viz:Serving from cache
2025-08-13 12:47:49,037:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:47:49,046:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:47:49,048:INFO:superset.viz:Serving from cache
2025-08-13 12:48:01,168:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:48:01,178:INFO:superset.viz:Cache key: 8612c36b186f7404f4f561f708b307ce
2025-08-13 12:48:13,091:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:48:13,101:INFO:superset.viz:Cache key: a14ccb29d3479143e0cea024627f9dd7
2025-08-13 12:48:19,749:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:48:19,758:INFO:superset.viz:Cache key: 8583ff715a48717fc790592e2c1374ec
2025-08-13 12:48:28,683:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:48:28,696:INFO:superset.viz:Cache key: 4a5fdb6e105d2af191dbc9eba08d8879
2025-08-13 12:48:28,697:INFO:superset.viz:Serving from cache
2025-08-13 12:49:30,393:WARNING:superset.views.error_handling:Exception
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1835, in get_sqla_query
    assert isinstance(eq, (tuple, list))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
2025-08-13 12:49:30,395:ERROR:superset.views.error_handling:
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1835, in get_sqla_query
    assert isinstance(eq, (tuple, list))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
2025-08-13 12:49:30,437:WARNING:superset.views.error_handling:Exception
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 189, in _get_results
    payload = _get_full(query_context, query_obj, force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1835, in get_sqla_query
    assert isinstance(eq, (tuple, list))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
2025-08-13 12:49:30,439:ERROR:superset.views.error_handling:
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1484, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask/app.py", line 1469, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/flask_appbuilder/security/decorators.py", line 109, in wraps
    return f(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/views/base_api.py", line 120, in wraps
    duration, response = time_function(f, self, *args, **kwargs)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/core.py", line 1369, in time_function
    response = func(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 260, in data
    return self._get_data_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/utils/log.py", line 304, in wrapper
    value = f(*args, **kwargs)
            ^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/charts/data/api.py", line 423, in _get_data_response
    result = command.run(force_cached=force_cached)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/commands/chart/data/get_data_command.py", line 45, in run
    payload = self._query_context.get_payload(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 102, in get_payload
    return self._processor.get_payload(cache_query_context, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 753, in get_payload
    get_query_results(
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 227, in get_query_results
    return result_func(query_context, query_obj, force_cached)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 189, in _get_results
    payload = _get_full(query_context, query_obj, force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_actions.py", line 103, in _get_full
    payload = query_context.get_df_payload(query_obj, force_cached=force_cached)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context.py", line 123, in get_df_payload
    return self._processor.get_df_payload(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 162, in get_df_payload
    query_result = self.get_query_result(query_obj)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/common/query_context_processor.py", line 265, in get_query_result
    result = query_context.datasource.query(query_object.to_dict())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/connectors/sqla/models.py", line 1716, in query
    query_str_ext = self.get_query_str_extended(query_obj)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 887, in get_query_str_extended
    sqlaq = self.get_sqla_query(**query_obj)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/superset/models/helpers.py", line 1835, in get_sqla_query
    assert isinstance(eq, (tuple, list))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError
2025-08-13 12:52:03,263:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 12:52:03,264:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 12:53:00,344:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:53:00,356:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:53:00,358:INFO:superset.viz:Serving from cache
2025-08-13 12:53:04,607:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:53:04,617:INFO:superset.viz:Cache key: e58b70cf4212add158021d9ed28d18e7
2025-08-13 12:53:17,997:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:53:18,007:INFO:superset.viz:Cache key: b9f52a9bd0c43d019e691a5eb3ae5b8a
2025-08-13 12:53:18,010:INFO:superset.viz:Serving from cache
2025-08-13 12:54:03,145:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 12:54:03,146:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 12:54:20,771:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:54:20,785:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:54:20,787:INFO:superset.viz:Serving from cache
2025-08-13 12:54:25,568:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:54:25,581:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:54:25,583:INFO:superset.viz:Serving from cache
2025-08-13 12:54:33,043:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:54:33,061:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:54:33,063:INFO:superset.viz:Serving from cache
2025-08-13 12:55:24,829:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:55:24,839:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:55:24,840:INFO:superset.viz:Serving from cache
2025-08-13 12:55:35,651:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 12:55:35,651:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 12:55:56,948:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:55:56,962:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:55:56,965:INFO:superset.viz:Serving from cache
2025-08-13 12:56:12,414:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:56:12,425:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:56:12,426:INFO:superset.viz:Serving from cache
2025-08-13 12:56:25,276:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:56:25,285:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:56:25,287:INFO:superset.viz:Serving from cache
2025-08-13 12:56:34,540:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:56:34,550:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 12:56:34,552:INFO:superset.viz:Serving from cache
2025-08-13 12:56:38,814:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 12:56:38,826:INFO:superset.viz:Cache key: 4a5fdb6e105d2af191dbc9eba08d8879
2025-08-13 12:56:38,828:INFO:superset.viz:Serving from cache
2025-08-13 14:39:23,241:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 14:39:23,253:INFO:superset.viz:Cache key: 4a5fdb6e105d2af191dbc9eba08d8879
2025-08-13 14:39:23,256:INFO:superset.viz:Serving from cache
2025-08-13 14:39:35,796:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 14:39:35,806:INFO:superset.viz:Cache key: b7fc66b34febb1f2cf8e2f7ab1dd5891
2025-08-13 14:40:37,064:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 14:40:37,073:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 14:40:46,127:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 14:40:46,136:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 14:40:46,137:INFO:superset.viz:Serving from cache
2025-08-13 14:40:52,093:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 14:40:52,104:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 14:40:52,105:INFO:superset.viz:Serving from cache
2025-08-13 18:38:59,480:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:38:59,490:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 18:41:08,071:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:41:08,081:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 18:41:08,082:INFO:superset.viz:Serving from cache
2025-08-13 18:47:00,463:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:47:00,472:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 18:47:00,474:INFO:superset.viz:Serving from cache
2025-08-13 18:47:17,259:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:47:17,269:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 18:47:17,271:INFO:superset.viz:Serving from cache
2025-08-13 18:47:17,510:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:47:17,520:INFO:superset.viz:Cache key: 7f81f3aaa969902112e21481e9d81ca6
2025-08-13 18:47:17,521:INFO:superset.viz:Serving from cache
2025-08-13 18:47:18,926:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:47:18,937:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 18:47:20,600:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 18:47:20,600:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 18:47:21,676:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:47:21,689:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 18:47:21,691:INFO:superset.viz:Serving from cache
2025-08-13 18:48:15,260:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:48:15,271:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 18:48:15,272:INFO:superset.viz:Serving from cache
2025-08-13 18:48:22,830:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:48:22,842:INFO:superset.viz:Cache key: 4664c19bbc5b8d3e09edb2a265c813e8
2025-08-13 18:49:02,786:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:49:02,799:INFO:superset.viz:Cache key: 4664c19bbc5b8d3e09edb2a265c813e8
2025-08-13 18:49:02,800:INFO:superset.viz:Serving from cache
2025-08-13 18:49:29,701:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:49:29,711:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 18:49:29,713:INFO:superset.viz:Serving from cache
2025-08-13 18:49:41,241:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:49:41,254:INFO:superset.viz:Cache key: a2ba5d26f3a9f11ec11841424b66dda4
2025-08-13 18:50:23,633:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:50:23,644:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 18:50:23,646:INFO:superset.viz:Serving from cache
2025-08-13 18:50:48,205:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 18:50:48,216:INFO:superset.viz:Cache key: 952a9552efb39129a35ea9eb709298bf
2025-08-13 19:03:58,311:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 19:03:58,311:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 19:04:59,110:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 19:04:59,110:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 19:06:19,134:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 19:06:19,134:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 19:07:06,261:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 19:07:06,261:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 19:07:09,123:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 19:07:09,134:INFO:superset.viz:Cache key: af9e95d5d3d07dc0943116471f0b7c9f
2025-08-13 19:08:13,430:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 19:08:13,445:INFO:superset.viz:Cache key: bc04d6eb352e99e908add989a3f365e7
2025-08-13 19:08:28,772:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 19:08:28,773:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 19:08:29,945:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 19:08:29,956:INFO:superset.viz:Cache key: af9e95d5d3d07dc0943116471f0b7c9f
2025-08-13 19:08:29,958:INFO:superset.viz:Serving from cache
2025-08-13 19:09:11,216:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 19:09:11,229:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 19:09:11,231:INFO:superset.viz:Serving from cache
2025-08-13 19:09:47,019:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 19:09:47,019:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 19:09:49,611:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 19:09:49,623:INFO:superset.viz:Cache key: 54506f676ad330e435045920dbb4d694
2025-08-13 20:52:07,097:WARNING:superset.views.base:Superset.explore_json This API endpoint is deprecated and will be removed in version 5.0.0
2025-08-13 20:52:07,109:INFO:superset.viz:Cache key: 5285b3142c2fa210d6891ecaec0f318a
2025-08-13 21:54:10,023:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 21:54:10,023:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
2025-08-13 23:22:43,175:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect metricflow: No module named 'python_graphql_client'
2025-08-13 23:22:43,175:WARNING:superset.db_engine_specs:Unable to load SQLAlchemy dialect shillelagh.multicorn2: No module named 'psycopg2'
[2025-08-14 00:29:02 +0800] [30598] [CRITICAL] WORKER TIMEOUT (pid:30622)
[2025-08-14 00:29:02 +0800] [30622] [ERROR] Error handling request (no URI read)
Traceback (most recent call last):
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/workers/sync.py", line 133, in handle
    req = next(parser)
          ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/parser.py", line 41, in __next__
    self.mesg = self.mesg_class(self.cfg, self.unreader, self.source_addr, self.req_count)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/message.py", line 259, in __init__
    super().__init__(cfg, unreader, peer_addr)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/message.py", line 60, in __init__
    unused = self.parse(self.unreader)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/message.py", line 271, in parse
    self.get_data(unreader, buf, stop=True)
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/message.py", line 262, in get_data
    data = unreader.read()
           ^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/unreader.py", line 36, in read
    d = self.chunk()
        ^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/http/unreader.py", line 63, in chunk
    return self.sock.recv(self.mxchunk)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/app/superset/superset-env/lib/python3.12/site-packages/gunicorn/workers/base.py", line 204, in handle_abort
    sys.exit(1)
SystemExit: 1
[2025-08-14 00:29:02 +0800] [30622] [INFO] Worker exiting (pid: 30622)
[2025-08-14 00:29:03 +0800] [30598] [ERROR] Worker (pid:30622) was sent SIGKILL! Perhaps out of memory?
[2025-08-14 00:29:03 +0800] [2821] [INFO] Booting worker with pid: 2821
Loaded your LOCAL configuration at [/data/app/superset/conf/superset_config.py]
2025-08-14 00:29:05,710:INFO:superset.initialization:Setting database isolation level to READ COMMITTED
